import{r as O,j as i}from"./radix-x8H_F-uE.js";import{c as ee,s as ie,g as oe,h as ne,C as ce,i as de,b as ue,d as fe,a as ge,D as me,e as he,j as ye,f as pe,k as Ce,L as ve}from"./index-CV_NrdTx.js";import{T as be,a as xe,b as Se,c as je}from"./tooltip-BzjzYoP0.js";import{M as _e}from"./ModLoaders-CJyvo1Po.js";import{d as Ve}from"./tanstack-aN5NUOUd.js";import{u as Ae,L as Fe,I as Me}from"./ListPageLayout-BgScUpIv.js";import{M as Ne}from"./minecraftVersions-C4FejwFY.js";import{S as we}from"./schematicsCategories-DTRG_eG_.js";import{C as $e}from"./createVersions-D2rj0mJU.js";import{S as G}from"./SelectFilter-CV4yDjGh.js";import{U as qe}from"./upload-D2vsks3K.js";import"./animation-RShxBXpy.js";import"./DevinsBadges-DG1A-i83.js";import"./funnel-BZzBqqm1.js";function Ee(t){const e=ee.c(36);let r;e[0]!==t?(r=t===void 0?{}:t,e[0]=t,e[1]=r):r=e[1];const v=r,{initialValues:c,onFilterChange:o}=v;let n;e[2]!==c?(n=c===void 0?{}:c,e[2]=c,e[3]=n):n=e[3];const s=n;let f;e[4]!==s?(f={query:"",page:1,category:"All",subCategory:"All",version:"All",loaders:"all",createVersion:"All",...s},e[4]=s,e[5]=f):f=e[5];const[y,w]=O.useState(f);let b;e[6]!==o?(b=(u,D)=>{w(T=>{const L={...T,[u]:D};return u==="category"&&(L.subCategory="All"),u!=="page"&&(L.page=1),o&&o(L),L})},e[6]=o,e[7]=b):b=e[7];const l=b;let g;e[8]!==l?(g=u=>l("query",u),e[8]=l,e[9]=g):g=e[9];const V=g;let h;e[10]!==l?(h=u=>l("page",u),e[10]=l,e[11]=h):h=e[11];const p=h;let C;e[12]!==l?(C=u=>l("category",u),e[12]=l,e[13]=C):C=e[13];const A=C;let x;e[14]!==l?(x=u=>l("subCategory",u),e[14]=l,e[15]=x):x=e[15];const a=x;let F;e[16]!==l?(F=u=>l("version",u),e[16]=l,e[17]=F):F=e[17];const $=F;let S;e[18]!==l?(S=u=>l("loaders",u),e[18]=l,e[19]=S):S=e[19];const j=S;let q;e[20]!==l?(q=u=>l("createVersion",u),e[20]=l,e[21]=q):q=e[21];const M=q;let _;e[22]!==s||e[23]!==o?(_=()=>{w({query:"",page:1,category:"All",subCategory:"All",version:"All",loaders:"all",createVersion:"All",...s}),o&&o({query:"",page:1,category:"All",subCategory:"All",version:"All",loaders:"all",createVersion:"All",...s})},e[22]=s,e[23]=o,e[24]=_):_=e[24];const m=_;let d;e[25]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{w(Le)},e[25]=d):d=e[25];const E=d;let N;return e[26]!==y||e[27]!==m||e[28]!==A||e[29]!==M||e[30]!==j||e[31]!==p||e[32]!==V||e[33]!==a||e[34]!==$?(N={filters:y,setQuery:V,setPage:p,setCategory:A,setSubCategory:a,setCreateVersion:M,setVersion:$,setLoaders:j,resetFilters:m,loadMore:E},e[26]=y,e[27]=m,e[28]=A,e[29]=M,e[30]=j,e[31]=p,e[32]=V,e[33]=a,e[34]=$,e[35]=N):N=e[35],N}function Le(t){return{...t,page:t.page+1}}function Oe(t={}){const{filters:e,setQuery:r,setPage:v,setCategory:c,setSubCategory:o,setVersion:n,setLoaders:s,setCreateVersion:f,resetFilters:y,loadMore:w}=Ee(t),b=we,l=Ne,g=$e,V=O.useMemo(()=>b.map(a=>({value:a.category,label:a.category})),[b]),h=O.useMemo(()=>b.find(a=>a.category===e.category),[e.category,b]),p=O.useMemo(()=>h?.subcategories?.length?h.subcategories.map(a=>({value:a,label:a})):[],[h]),C=O.useMemo(()=>l.map(a=>({value:a.value,label:a.value})),[l]),A=O.useMemo(()=>[{value:"all",label:"All"},{value:"forge",label:"Forge"},{value:"fabric",label:"Fabric"}],[]),x=O.useMemo(()=>Object.values(g).map(a=>({value:a.value,label:a.label})),[g]);return{filters:e,setQuery:r,setPage:v,setCategory:c,setSubCategory:o,setVersion:n,setLoaders:s,setCreateVersion:f,resetFilters:y,loadMore:w,categoryOptions:V,createVersionOptions:x,subCategoryOptions:p,versionOptions:C,loaderOptions:A,hasSubCategories:p.length>0}}const Te=t=>{const e=ee.c(46);let r,v,c,o,n,s,f,y;if(e[0]!==t){const{query:m,page:d,category:E,sub_categories:N,version:u,loaders:D,create_versions:T,id:L}=t;s=m===void 0?"":m,n=d===void 0?1:d,r=E===void 0?"All":E,f=N===void 0?"All":N,y=u===void 0?"all":u,o=D===void 0?"all":D,v=T===void 0?"All":T,c=L===void 0?"all":L,console.log("search triggered"),s===""&&(s="*"),e[0]=t,e[1]=r,e[2]=v,e[3]=c,e[4]=o,e[5]=n,e[6]=s,e[7]=f,e[8]=y}else r=e[1],v=e[2],c=e[3],o=e[4],n=e[5],s=e[6],f=e[7],y=e[8];let w;e[9]!==r||e[10]!==v||e[11]!==c||e[12]!==o||e[13]!==f||e[14]!==y?(w=()=>{const m=[],d=(E,N)=>{if(N&&N!=="all"&&N!=="All"){const u=N.includes(" ")?`"${N}"`:N;m.push(`${E} = ${u}`)}};return d("modloaders",o),d("categories",r),d("subCategories",f),d("user_id",c),d("game_versions",y),d("create_versions",v),m.length>0?m.join(" AND "):""},e[9]=r,e[10]=v,e[11]=c,e[12]=o,e[13]=f,e[14]=y,e[15]=w):w=e[15];const b=w;let l;e[16]!==r||e[17]!==v||e[18]!==c||e[19]!==o||e[20]!==n||e[21]!==s||e[22]!==f||e[23]!==y?(l=["searchSchematics",s,n,r,f,y,o,v,c],e[16]=r,e[17]=v,e[18]=c,e[19]=o,e[20]=n,e[21]=s,e[22]=f,e[23]=y,e[24]=l):l=e[24];let g;e[25]!==b||e[26]!==n||e[27]!==s?(g=async()=>{const d=await ie.index("schematics").search(s,{limit:20,offset:(n-1)*20,filter:b()}),E=d.hits;return{data:Array.isArray(E)?E:[],totalHits:d.estimatedTotalHits??0}},e[25]=b,e[26]=n,e[27]=s,e[28]=g):g=e[28];const V=!!s;let h;e[29]!==l||e[30]!==g||e[31]!==V?(h={queryKey:l,queryFn:g,staleTime:3e5,enabled:V},e[29]=l,e[30]=g,e[31]=V,e[32]=h):h=e[32];const p=Ve(h),{data:C,isLoading:A,isError:x,error:a,isFetching:F}=p;let $;e[33]!==C?.data?($=C?.data??[],e[33]=C?.data,e[34]=$):$=e[34];const S=$,j=C?.totalHits??0,q=(n-1)*20+S.length<j,M=n>1;let _;return e[35]!==a||e[36]!==q||e[37]!==M||e[38]!==x||e[39]!==F||e[40]!==A||e[41]!==n||e[42]!==p||e[43]!==S||e[44]!==j?(_={...p,data:S,hasNextPage:q,hasPreviousPage:M,totalHits:j,page:n,isLoading:A,isError:x,error:a,isFetching:F},e[35]=a,e[36]=q,e[37]=M,e[38]=x,e[39]=F,e[40]=A,e[41]=n,e[42]=p,e[43]=S,e[44]=j,e[45]=_):_=e[45],_},De=t=>{const e=ee.c(46),{schematic:r,onClick:v}=t,c=oe(),o=Ie,n=Re,{mutate:s}=ne();let f;e[0]!==s||e[1]!==c||e[2]!==r.$id||e[3]!==r.schematic_url?(f=M=>{M.stopPropagation(),s(r.$id),c(r.schematic_url)},e[0]=s,e[1]=c,e[2]=r.$id,e[3]=r.schematic_url,e[4]=f):f=e[4];const y=f;let w;e[5]!==r?(w=()=>JSON.stringify(r,null,2),e[5]=r,e[6]=w):w=e[6];const b=w,l=Array.isArray(r.image_urls)&&r.image_urls.length>0?r.image_urls[0]:"";let g;e[7]!==r.title||e[8]!==l?(g=i.jsx("div",{className:"h-40 overflow-hidden",children:i.jsx("img",{className:"h-full w-full rounded-t-md object-cover",alt:r.title,src:l})}),e[7]=r.title,e[8]=l,e[9]=g):g=e[9];let V;e[10]!==r.title?(V=i.jsx(ce,{children:r.title}),e[10]=r.title,e[11]=V):V=e[11];let h;e[12]!==r.description?(h=r.description.slice(0,150),e[12]=r.description,e[13]=h):h=e[13];let p;e[14]!==h?(p=i.jsxs(ue,{children:[h,"..."]}),e[14]=h,e[15]=p):p=e[15];let C;e[16]!==V||e[17]!==p?(C=i.jsxs(fe,{className:"grow",children:[V,p]}),e[16]=V,e[17]=p,e[18]=C):C=e[18];let A;e[19]!==r.modloaders?(A=i.jsxs("div",{children:["Modloader: ",i.jsx(_e,{loaders:r.modloaders})]}),e[19]=r.modloaders,e[20]=A):A=e[20];let x;e[21]!==r.game_versions?(x=n(r.game_versions),e[21]=r.game_versions,e[22]=x):x=e[22];let a;e[23]!==x?(a=i.jsxs("div",{children:["Made for Minecraft:",i.jsx("div",{className:"flex grow gap-2",children:x})]}),e[23]=x,e[24]=a):a=e[24];let F;e[25]!==a||e[26]!==A?(F=i.jsxs(ge,{children:[A,a]}),e[25]=a,e[26]=A,e[27]=F):F=e[27];let $;e[28]===Symbol.for("react.memo_cache_sentinel")?($=i.jsx(me,{}),e[28]=$):$=e[28];let S;e[29]!==y?(S=i.jsx(he,{className:"mt-auto",children:i.jsxs(ye,{variant:"default",className:"w-full text-center",onClick:y,children:[$," Download"]})}),e[29]=y,e[30]=S):S=e[30];let j;e[31]!==v||e[32]!==F||e[33]!==S||e[34]!==g||e[35]!==C?(j=i.jsxs(pe,{className:"bg flex h-full cursor-pointer flex-col rounded-lg transition-shadow hover:shadow-lg",onClick:v,children:[g,C,F,S]}),e[31]=v,e[32]=F,e[33]=S,e[34]=g,e[35]=C,e[36]=j):j=e[36];const q=j;if(o()){let M;e[37]!==q?(M=i.jsx(be,{asChild:!0,children:q}),e[37]=q,e[38]=M):M=e[38];let _;e[39]!==b?(_=b(),e[39]=b,e[40]=_):_=e[40];let m;e[41]!==_?(m=i.jsx(xe,{side:"right",className:"max-h-96 max-w-md overflow-auto",children:i.jsx("pre",{className:"text-xs whitespace-pre-wrap",children:_})}),e[41]=_,e[42]=m):m=e[42];let d;return e[43]!==M||e[44]!==m?(d=i.jsx(Se,{children:i.jsxs(je,{children:[M,m]})}),e[43]=M,e[44]=m,e[45]=d):d=e[45],d}return q};function Ie(){try{return localStorage.getItem("debug")==="true"}catch{return!1}}function Pe(t,e){return i.jsx(de,{variant:"accent",children:t},`mc-version-${t}-${e}`)}function Re(t){return(Array.isArray(t)?t:[]).map(Pe)}function st(){const t=ee.c(73),e=oe();let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],t[0]=r):r=t[0];const[v,c]=O.useState(r),[o,n]=O.useState(1),{filters:s,setQuery:f,setCategory:y,setSubCategory:w,setCreateVersion:b,setVersion:l,setLoaders:g,resetFilters:V,categoryOptions:h,createVersionOptions:p,subCategoryOptions:C,versionOptions:A,loaderOptions:x,hasSubCategories:a}=Oe();let F;t[1]!==f?(F=I=>{f(I),n(1),c([])},t[1]=f,t[2]=F):F=t[2];const $=F;let S;t[3]!==s||t[4]!==o?(S={...s,page:o},t[3]=s,t[4]=o,t[5]=S):S=t[5];const{data:j,isLoading:q,isError:M,isFetching:_,hasNextPage:m}=Te(S),d=q||_;let E;t[6]!==m||t[7]!==_||t[8]!==o?(E=()=>{m&&!_&&(console.log("Loading more schematics. Current page:",o),n(He))},t[6]=m,t[7]=_,t[8]=o,t[9]=E):E=t[9];let N;t[10]!==m||t[11]!==d||t[12]!==E?(N={loading:d,hasMore:m,onLoadMore:E},t[10]=m,t[11]=d,t[12]=E,t[13]=N):N=t[13];const{sentinelRef:u,loadingMore:D}=Ae(N);let T;t[14]===Symbol.for("react.memo_cache_sentinel")?(T=()=>{c([]),n(1)},t[14]=T):T=t[14];let L;t[15]!==s.category||t[16]!==s.createVersion||t[17]!==s.loaders||t[18]!==s.query||t[19]!==s.subCategory||t[20]!==s.version?(L=[s.query,s.category,s.subCategory,s.version,s.loaders,s.createVersion],t[15]=s.category,t[16]=s.createVersion,t[17]=s.loaders,t[18]=s.query,t[19]=s.subCategory,t[20]=s.version,t[21]=L):L=t[21],O.useEffect(T,L);let J,K;t[22]!==o||t[23]!==j?(J=()=>{j&&j.length>0&&c(o===1?j:I=>[...I,...j])},K=[j,o],t[22]=o,t[23]=j,t[24]=J,t[25]=K):(J=t[24],K=t[25]),O.useEffect(J,K);let z;t[26]!==V?(z=()=>{V(),n(1),c([])},t[26]=V,t[27]=z):z=t[27];const te=z,se=s.category!==""||s.subCategory!==""||s.version!==""||s.loaders!==""||s.createVersion!==""||s.query!=="";let P;t[28]!==h||t[29]!==s.category||t[30]!==y?(P=i.jsx(G,{label:"Category",value:s.category,onChange:y,options:h,placeholder:"Select Category"}),t[28]=h,t[29]=s.category,t[30]=y,t[31]=P):P=t[31];let R;t[32]!==s.subCategory||t[33]!==a||t[34]!==w||t[35]!==C?(R=a&&i.jsx(G,{label:"Subcategory",value:s.subCategory||"",onChange:w,options:C}),t[32]=s.subCategory,t[33]=a,t[34]=w,t[35]=C,t[36]=R):R=t[36];let H;t[37]!==s.version||t[38]!==l||t[39]!==A?(H=i.jsx(G,{label:"Version",value:s.version,onChange:l,options:A}),t[37]=s.version,t[38]=l,t[39]=A,t[40]=H):H=t[40];let Q;t[41]!==s.loaders||t[42]!==x||t[43]!==g?(Q=i.jsx(G,{label:"Loaders",value:s.loaders,onChange:g,options:x}),t[41]=s.loaders,t[42]=x,t[43]=g,t[44]=Q):Q=t[44];let k;t[45]!==p||t[46]!==s.createVersion||t[47]!==b?(k=i.jsx(G,{label:"Create version",value:s.createVersion,onChange:b,options:p}),t[45]=p,t[46]=s.createVersion,t[47]=b,t[48]=k):k=t[48];let W;t[49]!==P||t[50]!==R||t[51]!==H||t[52]!==Q||t[53]!==k?(W=i.jsxs(i.Fragment,{children:[P,R,H,Q,k]}),t[49]=P,t[50]=R,t[51]=H,t[52]=Q,t[53]=k,t[54]=W):W=t[54];const re=W;let X;t[55]===Symbol.for("react.memo_cache_sentinel")?(X=Ce({variant:"default"}),t[55]=X):X=t[55];let Y;t[56]===Symbol.for("react.memo_cache_sentinel")?(Y=i.jsxs(ve,{className:X,to:"../schematics/upload",children:[i.jsx(qe,{className:"mr-2 h-4 w-4"})," Upload Schematic"]}),t[56]=Y):Y=t[56];const ae=Y;let B;t[57]!==e?(B=I=>i.jsx(De,{schematic:I,onClick:()=>e(`../schematics/${I.$id}/${I.slug}`)},I.$id),t[57]=e,t[58]=B):B=t[58];const le=q&&o===1;let U;t[59]!==v||t[60]!==M||t[61]!==D||t[62]!==u||t[63]!==B||t[64]!==le?(U=i.jsx(Me,{items:v,renderItem:B,isLoading:le,isError:M,emptyMessage:"No schematics found.",errorMessage:"Oops! Failed to load schematics.",infiniteScrollEnabled:!0,loadingMore:D,sentinelRef:u}),t[59]=v,t[60]=M,t[61]=D,t[62]=u,t[63]=B,t[64]=le,t[65]=U):U=t[65];let Z;return t[66]!==s.query||t[67]!==re||t[68]!==te||t[69]!==$||t[70]!==se||t[71]!==U?(Z=i.jsx(Fe,{searchValue:s.query,onSearchChange:$,searchPlaceholder:"Search schematics...",filters:re,onResetFilters:te,filterTitle:"Schematic Filters",hasActiveFilters:se,headerContent:ae,children:U}),t[66]=s.query,t[67]=re,t[68]=te,t[69]=$,t[70]=se,t[71]=U,t[72]=Z):Z=t[72],Z}function He(t){return t+1}export{st as default};
