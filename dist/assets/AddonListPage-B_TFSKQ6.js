import{r as N,j as r}from"./radix-bXgmYFMM.js";import{ag as Fe,c as X,ao as _e,p as je,P as De,ap as ye,aq as we,ar as Ne,as as Se,Q as Ae,h as Oe,d as Le,W as ke,a as Te,f as Ee,D as Pe,r as Ce,Z as Me,v as Ve,s as Re,t as Ue,x as Ie,y as Qe,at as Be,au as ue,av as fe,aw as de,ax as me,ay as he,az as pe,aa as qe,aA as ze,aB as xe,g as Ge,I as Ze}from"./index-BNMRn6sK.js";import{u as Je}from"./useSearchAddons-BfnTWvSC.js";import{L as He}from"./ListPageLayout-DGGzMnxd.js";import{B as Ke}from"./badge-check-C9T5cEId.js";import{M as We}from"./ModPageLinks-06H67Kr1.js";import{d as ve}from"./tanstack-57jHkLwp.js";import"./animation-CiItlcC_.js";const Xe=Fe.map(t=>t.value.toLowerCase()),Ye=t=>t.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),et=t=>{const e=X.c(5),{categories:s}=t;let l,a;if(e[0]!==s){a=Symbol.for("react.early_return_sentinel");e:{const h=_e(s);if(h.length===0){a=null;break e}l=[...new Set(h.filter(st).map(rt))].map(Ye)}e[0]=s,e[1]=l,e[2]=a}else l=e[1],a=e[2];if(a!==Symbol.for("react.early_return_sentinel"))return a;const c=l;if(c.length===0)return null;let u;return e[3]!==c?(u=r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:c.map(at)}),e[3]=c,e[4]=u):u=e[4],u},tt=N.memo(et);function st(t){return!Xe.includes(t)}function rt(t){return t.toLowerCase()}function at(t){return r.jsx(je,{children:t},t)}const lt=t=>{const e=X.c(7),{versions:s}=t;let l,a,c;if(e[0]!==s){c=Symbol.for("react.early_return_sentinel");e:{const h=_e(s);if(h.length===0){c=null;break e}l="mt-3 flex flex-wrap gap-1.5",a=h.map(it)}e[0]=s,e[1]=l,e[2]=a,e[3]=c}else l=e[1],a=e[2],c=e[3];if(c!==Symbol.for("react.early_return_sentinel"))return c;let u;return e[4]!==l||e[5]!==a?(u=r.jsx("div",{className:l,children:a}),e[4]=l,e[5]=a,e[6]=u):u=e[6],u};function it(t){return r.jsx(je,{variant:"secondary",className:"px-1.5 py-0.5 font-mono text-xs",children:t},t)}const ot=t=>{const e=X.c(18),{authors:s,downloads:l,claimed_by:a}=t;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=r.jsx(De,{className:"h-3.5"}),e[0]=c):c=e[0];let u;e[1]!==s?(u=s&&s.length>0?s.join(", "):"Unknown",e[1]=s,e[2]=u):u=e[2];let h;e[3]!==u?(h=r.jsx("span",{className:"truncate",children:u}),e[3]=u,e[4]=h):h=e[4];let n;e[5]!==a?(n=a&&r.jsx(ye,{children:r.jsxs(we,{children:[r.jsx(Ne,{children:r.jsx("span",{className:"text-primary inline text-xs",children:r.jsx(Ke,{className:"text-primary h-3.5"})})}),r.jsx(Se,{children:"The addon has been verified and it is owned by that user"})]})}),e[5]=a,e[6]=n):n=e[6];let y;e[7]!==h||e[8]!==n?(y=r.jsxs("div",{className:"flex items-center gap-0.5 border-b pb-1",children:[c,h,n]}),e[7]=h,e[8]=n,e[9]=y):y=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(Ae,{className:"h-3.5"}),e[10]=g):g=e[10];let w;e[11]!==l?(w=l.toLocaleString(),e[11]=l,e[12]=w):w=e[12];let v;e[13]!==w?(v=r.jsxs("div",{className:"flex items-center gap-0.5 border-b pb-1",children:[g,r.jsx("span",{className:"mr-1",children:w})]}),e[13]=w,e[14]=v):v=e[14];let S;return e[15]!==y||e[16]!==v?(S=r.jsxs("div",{className:"text-foreground-muted mt-3 flex items-center justify-between text-xs",children:[y,v]}),e[15]=y,e[16]=v,e[17]=S):S=e[17],S},nt=t=>{const e=X.c(65),{addon:s}=t,l=Oe();let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],e[0]=a):a=e[0];const[c,u]=N.useState(a);let h,n;e[1]!==s.curseforge_raw||e[2]!==s.modrinth_raw?(h=()=>{const x=[];s.curseforge_raw&&x.push("curseforge"),s.modrinth_raw&&x.push("modrinth"),u(x)},n=[s.curseforge_raw,s.modrinth_raw],e[1]=s.curseforge_raw,e[2]=s.modrinth_raw,e[3]=h,e[4]=n):(h=e[3],n=e[4]),N.useEffect(h,n);const y=ft;let g;e[5]!==s.slug||e[6]!==l?(g=()=>{l(`/addons/${s.slug}`)},e[5]=s.slug,e[6]=l,e[7]=g):g=e[7];const w=g;let v;e[8]===Symbol.for("react.memo_cache_sentinel")?(v=x=>{const G={basicInfo:{name:x.name||"MISSING",displayName:y(x),slug:x.slug,authors:x.authors},rawDataInfo:{curseforge_raw_type:typeof x.curseforge_raw,curseforge_raw_length:typeof x.curseforge_raw=="string"?x.curseforge_raw.length:x.curseforge_raw?"object":"null",curseforge_raw_preview:typeof x.curseforge_raw=="string"?x.curseforge_raw.substring(0,100)+"...":x.curseforge_raw?"Object present":"null",modrinth_raw_type:typeof x.modrinth_raw,modrinth_raw_length:typeof x.modrinth_raw=="string"?x.modrinth_raw.length:x.modrinth_raw?"object":"null",modrinth_raw_preview:typeof x.modrinth_raw=="string"?x.modrinth_raw.substring(0,100)+"...":x.modrinth_raw?"Object present":"null"},fullData:x};return JSON.stringify(G,null,2)},e[8]=v):v=e[8];const S=v,q=ht,z=xt,f=_t,o=typeof window<"u"&&window.localStorage.getItem("debug")==="true",d=s.icon||"/assets/wrench.webp";let m;e[9]!==s?(m=y(s),e[9]=s,e[10]=m):m=e[10];let j;e[11]!==d||e[12]!==m?(j=r.jsx("img",{src:d,alt:m,loading:"lazy",className:"h-12 w-12 object-cover"}),e[11]=d,e[12]=m,e[13]=j):j=e[13];let b;e[14]!==s?(b=y(s),e[14]=s,e[15]=b):b=e[15];let C;e[16]!==b?(C=r.jsx("h3",{className:"truncate text-sm font-medium",children:b}),e[16]=b,e[17]=C):C=e[17];let i;e[18]!==w||e[19]!==C||e[20]!==j?(i=r.jsxs(Le,{className:"relative flex cursor-pointer flex-row gap-3",onClick:w,children:[j,C]}),e[18]=w,e[19]=C,e[20]=j,e[21]=i):i=e[21];let $;e[22]!==s.description?($=r.jsx("p",{className:"text-foreground-muted text-xs",children:s.description}),e[22]=s.description,e[23]=$):$=e[23];let M;e[24]!==s.loaders?(M=q(s.loaders),e[24]=s.loaders,e[25]=M):M=e[25];let O;e[26]!==M?(O=r.jsx("div",{className:"mt-2 flex gap-2",children:r.jsx(ke,{loaders:M})}),e[26]=M,e[27]=O):O=e[27];let L;e[28]!==s.categories?(L=z(s.categories),e[28]=s.categories,e[29]=L):L=e[29];let V;e[30]!==L?(V=r.jsx(tt,{categories:L}),e[30]=L,e[31]=V):V=e[31];let R;e[32]!==s.minecraft_versions?(R=f(s.minecraft_versions),e[32]=s.minecraft_versions,e[33]=R):R=e[33];let F;e[34]!==R?(F=r.jsx(lt,{versions:R}),e[34]=R,e[35]=F):F=e[35];let U;e[36]!==$||e[37]!==O||e[38]!==V||e[39]!==F?(U=r.jsxs("div",{className:"flex-1",children:[$,O,V,F]}),e[36]=$,e[37]=O,e[38]=V,e[39]=F,e[40]=U):U=e[40];let D;e[41]!==s.authors||e[42]!==s.claimed_by||e[43]!==s.downloads?(D=r.jsx(ot,{authors:s.authors,downloads:s.downloads,claimed_by:s.claimed_by}),e[41]=s.authors,e[42]=s.claimed_by,e[43]=s.downloads,e[44]=D):D=e[44];const J=s.slug;let I;e[45]!==c?(I=c.includes("curseforge"),e[45]=c,e[46]=I):I=e[46];let B;e[47]!==c?(B=c.includes("modrinth"),e[47]=c,e[48]=B):B=e[48];let k;e[49]!==s.slug||e[50]!==I||e[51]!==B?(k=r.jsx(We,{slug:J,curseforge:I,modrinth:B}),e[49]=s.slug,e[50]=I,e[51]=B,e[52]=k):k=e[52];let A;e[53]!==U||e[54]!==D||e[55]!==k?(A=r.jsxs(Te,{className:"flex flex-1 flex-col gap-3",children:[U,D,k]}),e[53]=U,e[54]=D,e[55]=k,e[56]=A):A=e[56];let T;e[57]!==i||e[58]!==A?(T=r.jsx(Ne,{asChild:!0,children:r.jsxs(Ee,{className:"flex h-full flex-col overflow-hidden hover:shadow-xs",children:[i,A]})}),e[57]=i,e[58]=A,e[59]=T):T=e[59];let E;e[60]!==s?(E=o&&r.jsx(Se,{side:"right",className:"bg-surface-2 max-h-96 max-w-lg overflow-auto border p-4",children:r.jsxs("div",{className:"text-xs",children:[r.jsx("div",{className:"mb-2 font-semibold",children:"Raw Addon Data (Debug):"}),r.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap",children:S(s)})]})}),e[60]=s,e[61]=E):E=e[61];let Q;return e[62]!==T||e[63]!==E?(Q=r.jsx(ye,{delayDuration:500,children:r.jsxs(we,{open:o?void 0:!1,children:[T,E]})}),e[62]=T,e[63]=E,e[64]=Q):Q=e[64],Q},ct=N.memo(nt);function ut(t){return t.charAt(0).toUpperCase()+t.slice(1)}function ft(t){if(t.name)return t.name;if(t.modrinth_raw_parsed&&typeof t.modrinth_raw_parsed=="object"&&"title"in t.modrinth_raw_parsed)return t.modrinth_raw_parsed.title;if(t.curseforge_raw_parsed&&typeof t.curseforge_raw_parsed=="object"&&"name"in t.curseforge_raw_parsed)return t.curseforge_raw_parsed.name;if(typeof t.modrinth_raw=="string")try{const e=JSON.parse(t.modrinth_raw);if(e.title)return e.title}catch{}if(typeof t.curseforge_raw=="string")try{const e=JSON.parse(t.curseforge_raw);if(e.name)return e.name}catch{}return t.slug?t.slug.split("-").map(ut).join(" "):"Unknown Addon"}function dt(t){return t.trim()}function mt(t){return t.length>0}function ht(t){return t?Array.isArray(t)?t:typeof t=="string"?t.split(",").map(dt).filter(mt):[]:[]}function pt(t){return t.trim()}function gt(t){return t.length>0}function xt(t){return t?Array.isArray(t)?t:typeof t=="string"?t.split(",").map(pt).filter(gt):[]:[]}function vt(t){return t.trim()}function bt(t){return t.length>0}function _t(t){return t?Array.isArray(t)?t:typeof t=="string"?t.split(",").map(vt).filter(bt):[]:[]}const ge={categories:[],loaders:[],minecraft_versions:[],authors:[],sort:"relevance"},be=[{value:"relevance",label:"Relevance"},{value:"downloads:desc",label:"Most Downloaded"},{value:"downloads:asc",label:"Least Downloaded"},{value:"updated_at:desc",label:"Recently Updated"},{value:"created_at:desc",label:"Recently Added"},{value:"name:asc",label:"Name (A-Z)"},{value:"name:desc",label:"Name (Z-A)"}],jt=[{id:"popular-tech",name:"Popular Tech Mods",description:"Most downloaded technology mods",filters:{categories:["tech","industrial","automation"],sort:"downloads:desc"},icon:"âš™ï¸"},{id:"latest-magic",name:"Latest Magic Mods",description:"Recently updated magic mods",filters:{categories:["magic","enchantment","alchemy"],sort:"updated_at:desc"},icon:"âœ¨"},{id:"adventure-content",name:"Adventure Content",description:"Exploration and dungeon mods",filters:{categories:["adventure","exploration","dungeons","structures"],sort:"downloads:desc"},icon:"ðŸ—ºï¸"},{id:"performance",name:"Performance Mods",description:"Optimization and performance improvements",filters:{categories:["utility","performance","optimization"],sort:"downloads:desc"},icon:"âš¡"}],yt={Latest:["1.21.1","1.21","1.20.6","1.20.4","1.20.1"],LTS:["1.19.2","1.18.2","1.16.5","1.12.2"],Legacy:["1.7.10","1.6.4","1.5.2","1.4.7"]},wt=t=>{const e=X.c(11),{onApplyPreset:s}=t,[l,a]=N.useState(!1);let c;e[0]!==s?(c=v=>{s(v),a(!1)},e[0]=s,e[1]=c):c=e[1];const u=c;let h;e[2]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx(Pe,{asChild:!0,children:r.jsxs(Ce,{variant:"outline",size:"sm",className:"gap-2",children:[r.jsx(Me,{className:"h-4 w-4"}),"Quick Filters"]})}),e[2]=h):h=e[2];let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsxs(Ve,{children:[r.jsx(Re,{children:"Quick Filter Presets"}),r.jsx(Ue,{children:"Select a preset to quickly filter addons by popular categories"})]}),e[3]=n):n=e[3];let y;e[4]!==u?(y=jt.map(v=>r.jsxs("button",{onClick:()=>u(v),className:"flex items-start gap-3 rounded-lg border p-4 text-left transition-colors hover:bg-accent",children:[r.jsx("span",{className:"text-2xl",children:v.icon}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:v.name}),v.description&&r.jsx("div",{className:"text-sm text-muted-foreground",children:v.description})]})]},v.id)),e[4]=u,e[5]=y):y=e[5];let g;e[6]!==y?(g=r.jsxs(Ie,{className:"sm:max-w-[425px]",children:[n,r.jsx("div",{className:"grid gap-3 py-4",children:y})]}),e[6]=y,e[7]=g):g=e[7];let w;return e[8]!==l||e[9]!==g?(w=r.jsxs(Qe,{open:l,onOpenChange:a,children:[h,g]}),e[8]=l,e[9]=g,e[10]=w):w=e[10],w},Nt=t=>{const e=X.c(101),{filters:s,facets:l,onFilterChange:a,onClearFilters:c,onApplyPreset:u}=t;let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h={categories:!1,loaders:!1,versions:!1,authors:!1},e[0]=h):h=e[0];const[n,y]=N.useState(h);let g;e[1]===Symbol.for("react.memo_cache_sentinel")?(g=p=>{y(_=>({..._,[p]:!_[p]}))},e[1]=g):g=e[1];const w=g;let v;e[2]!==s.authors||e[3]!==s.categories||e[4]!==s.loaders||e[5]!==s.minecraft_versions||e[6]!==s.sort?(v=()=>{const p=[];if(s.categories.forEach(_=>{p.push({type:"category",value:_,label:`Category: ${_}`})}),s.loaders.forEach(_=>{p.push({type:"loader",value:_,label:`Loader: ${_}`})}),s.minecraft_versions.forEach(_=>{p.push({type:"version",value:_,label:`Version: ${_}`})}),s.authors.forEach(_=>{p.push({type:"author",value:_,label:`Author: ${_}`})}),s.sort&&s.sort!=="relevance"){const _=be.find(P=>P.value===s.sort)?.label||s.sort;p.push({type:"sort",value:s.sort,label:`Sort: ${_}`})}return p},e[2]=s.authors,e[3]=s.categories,e[4]=s.loaders,e[5]=s.minecraft_versions,e[6]=s.sort,e[7]=v):v=e[7];const S=v;let q;e[8]!==s.authors||e[9]!==s.categories||e[10]!==s.loaders||e[11]!==s.minecraft_versions||e[12]!==a?(q=(p,_)=>{e:switch(p){case"category":{a("categories",s.categories.filter(P=>P!==_));break e}case"loader":{a("loaders",s.loaders.filter(P=>P!==_));break e}case"version":{a("minecraft_versions",s.minecraft_versions.filter(P=>P!==_));break e}case"author":{a("authors",s.authors.filter(P=>P!==_));break e}case"sort":a("sort","relevance")}},e[8]=s.authors,e[9]=s.categories,e[10]=s.loaders,e[11]=s.minecraft_versions,e[12]=a,e[13]=q):q=e[13];const z=q;let f;e[14]!==S?(f=S(),e[14]=S,e[15]=f):f=e[15];const o=f;let d;e[16]!==l?(d=()=>l?.categories&&Object.keys(l.categories).length>0?Object.entries(l.categories).filter(St).map($t).sort(Ft):[{value:"tech",label:"Tech"},{value:"industrial",label:"Industrial"},{value:"automation",label:"Automation"},{value:"energy",label:"Energy"},{value:"magic",label:"Magic"},{value:"adventure",label:"Adventure"},{value:"decoration",label:"Decoration"},{value:"utility",label:"Utility"},{value:"worldgen",label:"World Gen"}],e[16]=l,e[17]=d):d=e[17];const m=d;let j;e[18]!==l?(j=()=>l?.loaders&&Object.keys(l.loaders).length>0?Object.entries(l.loaders).filter(Dt).map(At).sort(Ot):[{value:"Forge",label:"Forge"},{value:"Fabric",label:"Fabric"},{value:"NeoForge",label:"NeoForge"},{value:"Quilt",label:"Quilt"}],e[18]=l,e[19]=j):j=e[19];const b=j;let C;e[20]!==l?(C=()=>l?.minecraft_versions&&Object.keys(l.minecraft_versions).length>0?Object.entries(l.minecraft_versions).filter(Lt).map(kt).sort(Tt):[{value:"1.21.1",label:"1.21.1"},{value:"1.21",label:"1.21"},{value:"1.20.6",label:"1.20.6"},{value:"1.20.4",label:"1.20.4"},{value:"1.20.1",label:"1.20.1"},{value:"1.19.2",label:"1.19.2"},{value:"1.18.2",label:"1.18.2"},{value:"1.16.5",label:"1.16.5"},{value:"1.12.2",label:"1.12.2"}],e[20]=l,e[21]=C):C=e[21];const i=C;let $;e[22]!==l?($=()=>l?.authors&&Object.keys(l.authors).length>0?Object.entries(l.authors).slice(0,50).map(Et):[],e[22]=l,e[23]=$):$=e[23];const M=$;let O;e[24]!==u?(O=u&&r.jsx("div",{className:"flex justify-center",children:r.jsx(wt,{onApplyPreset:u})}),e[24]=u,e[25]=O):O=e[25];let L;e[26]!==o||e[27]!==c||e[28]!==z?(L=o.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-sm font-medium",children:["Active Filters (",o.length,")"]}),r.jsx(Ce,{variant:"ghost",size:"sm",onClick:c,className:"h-6 px-2 text-xs",children:"Clear All"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:o.map((p,_)=>r.jsx(Be,{label:p.label,onRemove:()=>z(p.type,p.value)},`${p.type}-${p.value}-${_}`))})]}),e[26]=o,e[27]=c,e[28]=z,e[29]=L):L=e[29];let V;e[30]===Symbol.for("react.memo_cache_sentinel")?(V=r.jsx("label",{className:"text-sm font-medium",children:"Sort By"}),e[30]=V):V=e[30];const R=s.sort||"relevance";let F;e[31]!==a?(F=p=>a("sort",p.target.value),e[31]=a,e[32]=F):F=e[32];let U;e[33]===Symbol.for("react.memo_cache_sentinel")?(U=be.map(Pt),e[33]=U):U=e[33];let D;e[34]!==R||e[35]!==F?(D=r.jsxs("div",{className:"space-y-2",children:[V,r.jsx(qe,{className:"h-10 w-full rounded-md border",children:r.jsx("select",{value:R,onChange:F,className:"w-full border-0 bg-background px-3 py-2 text-sm focus:outline-none",children:U})})]}),e[34]=R,e[35]=F,e[36]=D):D=e[36];const J=n.categories;let I;e[37]===Symbol.for("react.memo_cache_sentinel")?(I=()=>w("categories"),e[37]=I):I=e[37];let B;e[38]===Symbol.for("react.memo_cache_sentinel")?(B=r.jsx("span",{className:"text-sm font-medium",children:"Categories"}),e[38]=B):B=e[38];let k;e[39]!==n.categories?(k=r.jsxs(ue,{onClick:I,className:"flex w-full items-center justify-between rounded-md px-2 py-1 hover:bg-accent",children:[B,n.categories?r.jsx(fe,{className:"h-4 w-4"}):r.jsx(de,{className:"h-4 w-4"})]}),e[39]=n.categories,e[40]=k):k=e[40];let A;e[41]!==m?(A=m(),e[41]=m,e[42]=A):A=e[42];let T;e[43]!==s.categories||e[44]!==a?(T=p=>{const _=s.categories.includes(p)?s.categories.filter(P=>P!==p):[...s.categories,p];a("categories",_)},e[43]=s.categories,e[44]=a,e[45]=T):T=e[45];let E;e[46]!==s.categories||e[47]!==A||e[48]!==T?(E=r.jsx(me,{className:"pt-2",children:r.jsx(he,{options:A,selectedValues:s.categories,onToggle:T,searchable:!0,placeholder:"Search categories..."})}),e[46]=s.categories,e[47]=A,e[48]=T,e[49]=E):E=e[49];let Q;e[50]!==n.categories||e[51]!==k||e[52]!==E?(Q=r.jsxs(pe,{open:J,children:[k,E]}),e[50]=n.categories,e[51]=k,e[52]=E,e[53]=Q):Q=e[53];const x=n.loaders;let G;e[54]===Symbol.for("react.memo_cache_sentinel")?(G=()=>w("loaders"),e[54]=G):G=e[54];let H;e[55]===Symbol.for("react.memo_cache_sentinel")?(H=r.jsx("span",{className:"text-sm font-medium",children:"Mod Loaders"}),e[55]=H):H=e[55];let K;e[56]!==n.loaders?(K=r.jsxs(ue,{onClick:G,className:"flex w-full items-center justify-between rounded-md px-2 py-1 hover:bg-accent",children:[H,n.loaders?r.jsx(fe,{className:"h-4 w-4"}):r.jsx(de,{className:"h-4 w-4"})]}),e[56]=n.loaders,e[57]=K):K=e[57];let Z;e[58]!==b?(Z=b(),e[58]=b,e[59]=Z):Z=e[59];let W;e[60]!==s.loaders||e[61]!==a?(W=p=>{const _=s.loaders.includes(p)?s.loaders.filter(P=>P!==p):[...s.loaders,p];a("loaders",_)},e[60]=s.loaders,e[61]=a,e[62]=W):W=e[62];let Y;e[63]!==s.loaders||e[64]!==Z||e[65]!==W?(Y=r.jsx(me,{className:"pt-2",children:r.jsx(he,{options:Z,selectedValues:s.loaders,onToggle:W})}),e[63]=s.loaders,e[64]=Z,e[65]=W,e[66]=Y):Y=e[66];let ee;e[67]!==n.loaders||e[68]!==K||e[69]!==Y?(ee=r.jsxs(pe,{open:x,children:[K,Y]}),e[67]=n.loaders,e[68]=K,e[69]=Y,e[70]=ee):ee=e[70];const $e=n.versions;let oe;e[71]===Symbol.for("react.memo_cache_sentinel")?(oe=()=>w("versions"),e[71]=oe):oe=e[71];let ne;e[72]===Symbol.for("react.memo_cache_sentinel")?(ne=r.jsx("span",{className:"text-sm font-medium",children:"Minecraft Versions"}),e[72]=ne):ne=e[72];let te;e[73]!==n.versions?(te=r.jsxs(ue,{onClick:oe,className:"flex w-full items-center justify-between rounded-md px-2 py-1 hover:bg-accent",children:[ne,n.versions?r.jsx(fe,{className:"h-4 w-4"}):r.jsx(de,{className:"h-4 w-4"})]}),e[73]=n.versions,e[74]=te):te=e[74];let se;e[75]!==i?(se=i(),e[75]=i,e[76]=se):se=e[76];let re;e[77]!==s.minecraft_versions||e[78]!==a?(re=p=>{const _=s.minecraft_versions.includes(p)?s.minecraft_versions.filter(P=>P!==p):[...s.minecraft_versions,p];a("minecraft_versions",_)},e[77]=s.minecraft_versions,e[78]=a,e[79]=re):re=e[79];let ae;e[80]!==s.minecraft_versions||e[81]!==se||e[82]!==re?(ae=r.jsx(me,{className:"pt-2",children:r.jsx(he,{options:se,selectedValues:s.minecraft_versions,onToggle:re,searchable:!0,placeholder:"Search versions...",grouped:!0,groups:yt})}),e[80]=s.minecraft_versions,e[81]=se,e[82]=re,e[83]=ae):ae=e[83];let le;e[84]!==n.versions||e[85]!==te||e[86]!==ae?(le=r.jsxs(pe,{open:$e,children:[te,ae]}),e[84]=n.versions,e[85]=te,e[86]=ae,e[87]=le):le=e[87];let ie;e[88]!==n.authors||e[89]!==s.authors||e[90]!==M||e[91]!==a?(ie=M().length>0&&r.jsxs(pe,{open:n.authors,children:[r.jsxs(ue,{onClick:()=>w("authors"),className:"flex w-full items-center justify-between rounded-md px-2 py-1 hover:bg-accent",children:[r.jsx("span",{className:"text-sm font-medium",children:"Authors"}),n.authors?r.jsx(fe,{className:"h-4 w-4"}):r.jsx(de,{className:"h-4 w-4"})]}),r.jsx(me,{className:"pt-2",children:r.jsx(he,{options:M(),selectedValues:s.authors,onToggle:p=>{const _=s.authors.includes(p)?s.authors.filter(P=>P!==p):[...s.authors,p];a("authors",_)},searchable:!0,placeholder:"Search authors..."})})]}),e[88]=n.authors,e[89]=s.authors,e[90]=M,e[91]=a,e[92]=ie):ie=e[92];let ce;return e[93]!==O||e[94]!==L||e[95]!==D||e[96]!==Q||e[97]!==ee||e[98]!==le||e[99]!==ie?(ce=r.jsxs("div",{className:"space-y-4",children:[O,L,D,Q,ee,le,ie]}),e[93]=O,e[94]=L,e[95]=D,e[96]=Q,e[97]=ee,e[98]=le,e[99]=ie,e[100]=ce):ce=e[100],ce};function St(t){const[e,s]=t;return e&&e.length>1&&!e.includes(",")&&!e.includes("null")&&!e.includes("undefined")&&s>0}function Ct(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}function $t(t){const[e,s]=t,l=e.split(/[-_]/).map(Ct).join(" ");return{value:e,label:l,count:s}}function Ft(t,e){return e.count-t.count}function Dt(t){const[e,s]=t;return e&&e.length>1&&!e.includes(",")&&!e.includes("null")&&!e.includes("undefined")&&s>0}function At(t){const[e,s]=t;return{value:e,label:e,count:s}}function Ot(t,e){return e.count-t.count}function Lt(t){const[e,s]=t;return e&&e.match(/^\d+\.\d+(\.\d+)?$/)&&!e.includes(",")&&s>0}function kt(t){const[e,s]=t;return{value:e,label:e,count:s}}function Tt(t,e){const s=t.value.split(".").map(Number),l=e.value.split(".").map(Number);for(let a=0;a<Math.max(s.length,l.length);a++){const c=s[a]||0,u=l[a]||0;if(c!==u)return u-c}return 0}function Et(t){const[e,s]=t;return{value:e,label:e,count:s}}function Pt(t){return r.jsx("option",{value:t.value,children:t.label},t.value)}const Mt=()=>{const[t,e]=ze(),[s,l]=N.useState(()=>Vt(t)),[a,c]=N.useState(""),{data:u}=ve({queryKey:["all-addon-facets"],queryFn:async()=>{try{const o=await xe.index("addons").search("*",{facets:["categories","loaders","minecraft_versions","authors"],filter:"isValid = true",limit:0,attributesToRetrieve:[]}),d={};if(o.facetDistribution?.categories){const m={};Object.entries(o.facetDistribution.categories).forEach(([j,b])=>{j.split(",").map(i=>i.trim()).filter(i=>i).forEach(i=>{m[i]=(m[i]||0)+b})}),d.categories=m}if(o.facetDistribution?.loaders){const m={};Object.entries(o.facetDistribution.loaders).forEach(([j,b])=>{j.split(",").map(i=>i.trim()).filter(i=>i).forEach(i=>{m[i]=(m[i]||0)+b})}),d.loaders=m}if(o.facetDistribution?.minecraft_versions){const m={};Object.entries(o.facetDistribution.minecraft_versions).forEach(([j,b])=>{j.split(",").map(i=>i.trim()).filter(i=>i).forEach(i=>{m[i]=(m[i]||0)+b})}),d.minecraft_versions=m}return o.facetDistribution?.authors&&(d.authors=o.facetDistribution.authors),d}catch(f){return console.warn("Failed to fetch all facets:",f),{}}},staleTime:10*60*1e3,retry:!1}),{data:h,isLoading:n}=ve({queryKey:["addon-facets",s,a],queryFn:async()=>{try{const o=await xe.index("addons").search("*",{facets:["categories","loaders","minecraft_versions","authors"],filter:"isValid = true",limit:0,attributesToRetrieve:[]}),d={};if(o.facetDistribution?.categories){const m={};Object.entries(o.facetDistribution.categories).forEach(([j,b])=>{j.split(",").map(i=>i.trim()).filter(i=>i).forEach(i=>{m[i]=(m[i]||0)+b})}),d.categories=m}if(o.facetDistribution?.loaders){const m={};Object.entries(o.facetDistribution.loaders).forEach(([j,b])=>{j.split(",").map(i=>i.trim()).filter(i=>i).forEach(i=>{m[i]=(m[i]||0)+b})}),d.loaders=m}if(o.facetDistribution?.minecraft_versions){const m={};Object.entries(o.facetDistribution.minecraft_versions).forEach(([j,b])=>{j.split(",").map(i=>i.trim()).filter(i=>i).forEach(i=>{m[i]=(m[i]||0)+b})}),d.minecraft_versions=m}return o.facetDistribution?.authors&&(d.authors=o.facetDistribution.authors),d}catch(f){return console.warn("Failed to fetch facets, using fallback options:",f),{}}},staleTime:5*60*1e3,retry:!1}),y=N.useMemo(()=>{const f=[];if(f.push("isValid = true"),s.categories.length>0){const o=s.categories.map(d=>`categories = "${d}"`).join(" OR ");f.push(`(${o})`)}if(s.loaders.length>0){const o=s.loaders.map(d=>`loaders = "${d}"`).join(" OR ");f.push(`(${o})`)}if(s.minecraft_versions.length>0){const o=s.minecraft_versions.map(d=>`minecraft_versions = "${d}"`).join(" OR ");f.push(`(${o})`)}if(s.authors.length>0){const o=s.authors.map(d=>`authors = "${d}"`).join(" OR ");f.push(`(${o})`)}if(s.downloads&&(s.downloads.min!==void 0&&f.push(`downloads >= ${s.downloads.min}`),s.downloads.max!==void 0&&f.push(`downloads <= ${s.downloads.max}`)),s.lastUpdated){if(s.lastUpdated.from){const o=Math.floor(s.lastUpdated.from.getTime()/1e3);f.push(`updated_at >= ${o}`)}if(s.lastUpdated.to){const o=Math.floor(s.lastUpdated.to.getTime()/1e3);f.push(`updated_at <= ${o}`)}}return f.join(" AND ")},[s]),g=N.useCallback((f,o)=>{l(d=>({...d,[f]:o}))},[]),w=N.useCallback((f,o)=>{l(d=>{const m=d[f],j=m.includes(o)?m.filter(b=>b!==o):[...m,o];return{...d,[f]:j}})},[]),v=N.useCallback(()=>{l(ge),c("")},[]),S=N.useCallback(f=>{l(o=>({...ge,...f.filters}))},[]),q=N.useMemo(()=>s.categories.length>0||s.loaders.length>0||s.minecraft_versions.length>0||s.authors.length>0||s.downloads!==void 0||s.lastUpdated!==void 0||a!=="",[s,a]),z=N.useMemo(()=>{let f=0;return s.categories.length>0&&(f+=s.categories.length),s.loaders.length>0&&(f+=s.loaders.length),s.minecraft_versions.length>0&&(f+=s.minecraft_versions.length),s.authors.length>0&&(f+=s.authors.length),s.downloads&&f++,s.lastUpdated&&f++,f},[s]);return N.useEffect(()=>{const f=Rt(s,a);e(f,{replace:!0})},[s,a,e]),{filters:s,facets:h,allFacets:u,facetsLoading:n,filterString:y,searchQuery:a,setSearchQuery:c,updateFilter:g,toggleFilterValue:w,clearFilters:v,applyPreset:S,hasActiveFilters:q,activeFilterCount:z}};function Vt(t){const e={...ge},s=t.get("cat");s&&(e.categories=s.split(","));const l=t.get("loader");l&&(e.loaders=l.split(","));const a=t.get("v");a&&(e.minecraft_versions=a.split(","));const c=t.get("author");c&&(e.authors=c.split(","));const u=t.get("sort");u&&(e.sort=u);const h=t.get("min_dl"),n=t.get("max_dl");return(h||n)&&(e.downloads={min:h?parseInt(h):void 0,max:n?parseInt(n):void 0}),e}function Rt(t,e){const s=new URLSearchParams;return e&&s.set("q",e),t.categories.length>0&&s.set("cat",t.categories.join(",")),t.loaders.length>0&&s.set("loader",t.loaders.join(",")),t.minecraft_versions.length>0&&s.set("v",t.minecraft_versions.join(",")),t.authors.length>0&&s.set("author",t.authors.join(",")),t.sort&&t.sort!=="relevance"&&s.set("sort",t.sort),t.downloads?.min!==void 0&&s.set("min_dl",t.downloads.min.toString()),t.downloads?.max!==void 0&&s.set("max_dl",t.downloads.max.toString()),s}const Ut=()=>{const t=X.c(46),[e,s]=N.useState(1);let l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=[],t[0]=l):l=t[0];const[a,c]=N.useState(l),{filters:u,facets:h,allFacets:n,filterString:y,searchQuery:g,setSearchQuery:w,updateFilter:v,clearFilters:S,applyPreset:q,hasActiveFilters:z,activeFilterCount:f}=Mt();let o;t[1]!==y||t[2]!==u.sort||t[3]!==e||t[4]!==g?(o={query:g,page:e,filterString:y,sort:u.sort,limit:16,includeFacets:!0},t[1]=y,t[2]=u.sort,t[3]=e,t[4]=g,t[5]=o):o=t[5];const{data:d,isLoading:m,isFetching:j,hasNextPage:b,facetDistribution:C}=Je(o),i=m||j;let $;t[6]!==b||t[7]!==j||t[8]!==e?($=()=>{b&&!j&&(console.log("Loading more addons. Current page:",e),s(It))},t[6]=b,t[7]=j,t[8]=e,t[9]=$):$=t[9];let M;t[10]!==b||t[11]!==i||t[12]!==$?(M={loading:i,hasMore:b,onLoadMore:$},t[10]=b,t[11]=i,t[12]=$,t[13]=M):M=t[13];const{sentinelRef:O,loadingMore:L}=Ge(M);let V;t[14]===Symbol.for("react.memo_cache_sentinel")?(V=()=>{c([]),s(1)},t[14]=V):V=t[14];let R;t[15]!==y||t[16]!==u.sort||t[17]!==g?(R=[y,g,u.sort],t[15]=y,t[16]=u.sort,t[17]=g,t[18]=R):R=t[18],N.useEffect(V,R);let F;t[19]!==d||t[20]!==e?(F=()=>{d&&d.length>0&&(console.log(`New hits fetched: ${d.length} items`),c(e===1?d:H=>{const K=new Set(H.map(Qt)),Z=d.filter(W=>!K.has(W.$id));return Z.length>0?[...H,...Z]:H}))},t[19]=d,t[20]=e,t[21]=F):F=t[21];const U=d?.length;let D;t[22]!==e||t[23]!==U?(D=[U,e],t[22]=e,t[23]=U,t[24]=D):D=t[24],N.useEffect(F,D);let J;t[25]!==S?(J=()=>{S(),s(1),c([])},t[25]=S,t[26]=J):J=t[26];const I=J,B=Bt,k=n||C||h;let A;t[27]!==q||t[28]!==S||t[29]!==u||t[30]!==k||t[31]!==v?(A=r.jsx(Nt,{filters:u,facets:k,onFilterChange:v,onClearFilters:S,onApplyPreset:q}),t[27]=q,t[28]=S,t[29]=u,t[30]=k,t[31]=v,t[32]=A):A=t[32];const T=A,E=`Addon Filters${f>0?` (${f})`:""}`,Q=m&&e===1;let x;t[33]!==a||t[34]!==L||t[35]!==O||t[36]!==Q?(x=r.jsx(Ze,{items:a,renderItem:B,isLoading:Q,isError:!1,emptyMessage:"No addons found matching your filters.",infiniteScrollEnabled:!0,loadingMore:L,sentinelRef:O,animationEnabled:!0,animationDelay:.1,animationDuration:.4,staggerItemCount:16,skeletonCount:16}),t[33]=a,t[34]=L,t[35]=O,t[36]=Q,t[37]=x):x=t[37];let G;return t[38]!==T||t[39]!==I||t[40]!==z||t[41]!==g||t[42]!==w||t[43]!==E||t[44]!==x?(G=r.jsx(He,{searchValue:g,onSearchChange:w,searchPlaceholder:"Search addons...",filters:T,onResetFilters:I,filterTitle:E,hasActiveFilters:z,children:x}),t[38]=T,t[39]=I,t[40]=z,t[41]=g,t[42]=w,t[43]=E,t[44]=x,t[45]=G):G=t[45],G};function It(t){return t+1}function Qt(t){return t.$id}function Bt(t){return r.jsx(ct,{addon:t},t.$id)}function Xt(){const t=X.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(Ut,{}),t[0]=e):e=t[0],e}export{Xt as default};
