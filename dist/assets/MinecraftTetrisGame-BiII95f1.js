import{r as c,j as r}from"./radix-IrtRZmCq.js";import{r as Y}from"./index-KCZmE9lu.js";import{C as re}from"./cog-DqFJ4Al1.js";import"./tanstack-CU4_DkA7.js";import"./animation-ClyC9oE5.js";const m=10,b=20,A={I:"bg-cyan-500",J:"bg-blue-700",L:"bg-orange-500",O:"bg-yellow-500",S:"bg-green-500",T:"bg-purple-500",Z:"bg-red-500",empty:""},L={I:{name:"diamond",path:"/public/minecraft-textures/diamond_block.png"},J:{name:"lapis",path:"/public/minecraft-textures/lapis_block.png"},L:{name:"copper",path:"/public/minecraft-textures/copper_block.png"},O:{name:"gold",path:"/public/minecraft-textures/gold_block.png"},S:{name:"emerald",path:"/public/minecraft-textures/emerald_block.png"},T:{name:"obsidian",path:"/public/minecraft-textures/bookshelf.png"},Z:{name:"redstone",path:"/public/minecraft-textures/tnt_side.png"}},R={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],O:[[1,1],[1,1]],S:[[0,1,1],[1,1,0],[0,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]]},ne={QWERTY:{left:["a","A"],right:["d","D"],down:["s","S"],rotate:["w","W"],drop:[" "]},AZERTY:{left:["q","Q"],right:["d","D"],down:["s","S"],rotate:["z","Z"],drop:[" "]}},fe=()=>{const[h,M]=c.useState(J()),[l,w]=c.useState(null),[i,g]=c.useState({x:0,y:0}),[d,T]=c.useState(null),[f,W]=c.useState(0),[u,N]=c.useState(!1),[y,V]=c.useState(!1),[v,G]=c.useState(1),[Q,B]=c.useState(2e3),[Z,S]=c.useState(!1),[j,_]=c.useState(0),[k,I]=c.useState(0),[P,q]=c.useState("QWERTY");function J(){return Array(b).fill(null).map(()=>Array(m).fill(null))}const C=c.useCallback(()=>{const t=Object.keys(R),e=t[Math.floor(Math.random()*t.length)];return{shape:R[e],type:e}},[]),$=()=>{M(J());const t=C(),e=C();w(t),T(e),g({x:Math.floor(m/2)-1,y:0}),W(0),N(!1),S(!1),V(!0),G(1),B(1e3),I(0)},p=c.useCallback((t,e)=>{for(let s=0;s<t.shape.length;s++)for(let n=0;n<t.shape[s].length;n++)if(t.shape[s][n]){const a=e.x+n,o=e.y+s;if(a<0||a>=m||o>=b||o>=0&&h[o][a]!==null)return!1}return!0},[h]),H=c.useCallback((t,e)=>{for(let s=0;s<t.shape.length;s++)for(let n=0;n<t.shape[s].length;n++)if(t.shape[s][n]){const a=e.x+n,o=e.y+s;if(a<0||a>=m||o>=b||o>=0&&h[o][a]!==null)return!1}return!0},[h]),X=c.useCallback(()=>{if(!l||u)return;const t=[];for(let s=0;s<l.shape[0].length;s++){const n=[];for(let a=l.shape.length-1;a>=0;a--)n.push(l.shape[a][s]);t.push(n)}const e={...l,shape:t};p(e,i)&&w(e)},[l,i,u,p]),K=c.useCallback(t=>{let e=0;for(let s=b-1;s>=0;s--)if(t[s].every(n=>n!==null)){e+=1;for(let n=s;n>0;n--)t[n]=[...t[n-1]];t[0]=Array(m).fill(null),s+=1}if(e>0){const s=k+e;I(s);const n=f+e*100*v;W(n);const a=Math.floor(s/10)+1;a>v&&(G(a),B(Math.max(100,1e3-(a-1)*100)))}},[f,v,k]),E=c.useCallback(()=>{if(!l||!d)return;let t=!1;for(let a=0;a<l.shape.length;a++){for(let o=0;o<l.shape[a].length;o++)if(l.shape[a][o]&&i.y+a>=0){t=!0;break}if(t)break}if(!t){N(!0),S(!0),f>j&&_(f);return}const e=JSON.parse(JSON.stringify(h));for(let a=0;a<l.shape.length;a++)for(let o=0;o<l.shape[a].length;o++)if(l.shape[a][o]){const D=i.x+o,O=i.y+a;if(O>=0&&O<b&&D>=0&&D<m)e[O][D]=l.type;else if(O<0){N(!0),S(!0),f>j&&_(f);return}}M(e),K(e);const s=C(),n={x:Math.floor(m/2)-1,y:0};H(d,n)?(w(d),T(s),g(n)):(w(d),T(s),g(n),N(!0),S(!0),f>j&&_(f))},[h,l,d,i,C,f,j,H,K]),x=c.useCallback(t=>{if(!l||u)return!1;const e={...i};switch(t){case"left":e.x-=1;break;case"right":e.x+=1;break;case"down":e.y+=1;break;default:return!1}return p(l,e)?(g(e),!0):(t==="down"&&E(),!1)},[i,l,u,p,E]),z=c.useCallback(()=>{if(!l||u)return;let t={...i},e=!0;for(;e;)p(l,{...t,y:t.y+1})?t={...t,y:t.y+1}:e=!1;g(t),E()},[i,l,u,p,E]),F=()=>{q(t=>t==="QWERTY"?"AZERTY":"QWERTY")};c.useEffect(()=>{const t=e=>{if(!y||u)return;const s=ne[P];s.left.includes(e.key)?(x("left"),e.preventDefault()):s.right.includes(e.key)?(x("right"),e.preventDefault()):s.down.includes(e.key)?(x("down"),e.preventDefault()):s.rotate.includes(e.key)?(X(),e.preventDefault()):s.drop.includes(e.key)&&(z(),e.preventDefault())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[y,u,x,X,z,P]),c.useEffect(()=>{if(!y||u)return;const t=setInterval(()=>{x("down")},Q);return()=>{clearInterval(t)}},[y,u,x,Q]);const U=()=>{const t=JSON.parse(JSON.stringify(h));if(l){for(let e=0;e<l.shape.length;e++)for(let s=0;s<l.shape[e].length;s++)if(l.shape[e][s]){const n=i.x+s,a=i.y+e;a>=0&&a<b&&n>=0&&n<m&&(t[a][n]=l.type)}}return r.jsx("div",{className:"bg-brass_casing border-4 p-2",children:r.jsx("div",{className:"relative inline-block",children:t.map((e,s)=>r.jsx("div",{className:"flex",children:e.map((n,a)=>r.jsx("div",{className:`h-8 w-8 ${n?A[n]:A.empty} flex items-center justify-center`,children:n&&r.jsx("img",{src:L[n].path,alt:L[n].name,className:"h-full w-full object-cover"})},`${a}-${s}`))},s))})})},ee=()=>{const t=P==="QWERTY"?{move:"A/D",down:"S",rotate:"W"}:{move:"Q/D",down:"S",rotate:"Z"};return r.jsxs("div",{className:"font-minecraft text-white",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(re,{}),r.jsx("p",{children:" Controls:"})]}),r.jsx(Y,{onClick:F,variant:"outline",className:"m-2 cursor-pointer",children:P==="QWERTY"?"Switch to AZERTY":"Switch to QWERTY"}),r.jsxs("ul",{className:"list-disc pl-5",children:[r.jsxs("li",{children:[t.move,": Move left/right"]}),r.jsxs("li",{children:[t.down,": Move down"]}),r.jsxs("li",{children:[t.rotate,": Rotate"]})]})]})},te=()=>Z?r.jsx("div",{className:"bg-opacity-80 absolute inset-0 z-10 flex items-center justify-center bg-black",children:r.jsxs("div",{className:"bg-shadow_steel_casing w-5/6 rounded-lg p-8 text-center",children:[r.jsx("h2",{className:"mb-4 text-4xl font-bold text-red-500",children:"Game Over!"}),r.jsxs("div",{className:"mb-6 space-y-3",children:[r.jsxs("p",{className:"font-minecraft text-yellow-400",children:["Final Score: ",r.jsx("span",{className:"font-bold",children:f})]}),r.jsxs("p",{className:"font-minecraft text-green-400",children:["High Score: ",r.jsx("span",{className:"font-bold",children:Math.max(f,j)})]}),r.jsxs("p",{className:"font-minecraft text-blue-400",children:["Level Reached: ",r.jsx("span",{className:"font-bold",children:v})]}),r.jsxs("p",{className:"font-minecraft text-purple-400",children:["Lines Cleared: ",r.jsx("span",{className:"font-bold",children:k})]})]}),r.jsx(Y,{onClick:$,className:"font-minecraft w-full cursor-pointer",children:"New Game"})]})}):null,se=()=>d?r.jsxs("div",{className:"mb-4 p-4",children:[r.jsx("h3",{className:"font-minecraft text-center text-white",children:"Next Piece"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:`grid grid-cols-${R[d.type][0].length}`,children:R[d.type].map((t,e)=>t.map((s,n)=>r.jsx("div",{className:`h-5 w-5 ${s?A[d.type]:""}`,children:s===1&&r.jsx("img",{src:L[d.type].path,alt:L[d.type].name,className:"h-full w-full object-cover"})},`next-${n}-${e}`)))})})]}):null;return r.jsxs("div",{className:"flex flex-col items-center p-4",children:[r.jsx("h1",{className:"font-minecraft mb-4 text-3xl font-bold",children:"Minecraft Tetris"}),r.jsxs("div",{className:"flex flex-col items-start gap-8 md:flex-row",children:[r.jsxs("div",{className:"relative",children:[U(),te()]}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"bg-brass_casing mb-4 w-full p-4",children:[se(),r.jsxs("p",{className:"font-minecraft mb-2 text-xl text-yellow-400",children:["Score: ",f]}),r.jsxs("p",{className:"font-minecraft mb-2 text-xl text-green-400",children:["Level: ",v]}),r.jsxs("p",{className:"font-minecraft mb-2 text-xl text-blue-400",children:["Lines: ",k]}),u&&!Z&&r.jsx("div",{className:"mb-4 text-xl font-bold text-red-500",children:"Game Over!"}),r.jsx(Y,{onClick:$,variant:"default",className:"font-minecraft w-full cursor-pointer",children:y?"Restart":"Start"})]}),ee()]})]})]})};export{fe as default};
