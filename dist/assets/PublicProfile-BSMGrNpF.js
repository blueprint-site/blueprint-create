import{j as l}from"./radix-B53Irp0y.js";import{m as X,E as C,bT as g,c as Q,A as J,G as Z,n as I,bU as ee,r as se,K as te,Y as W,p as le,bV as ne,o as v,d as Y,f as R,a as G,_ as re,bW as O}from"./index-BYSF1fK8.js";import{d as H,e as ie,h as ae}from"./tanstack-BnyC6HL-.js";import"./animation-DCGi2G0G.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ce=X("user-minus",oe),de=e=>H({queryKey:["user",e],queryFn:async()=>{if(!e)throw new Error("User ID is required");try{const s=await C.listDocuments("main","users",[g.equal("$id",e)]);if(s.documents.length===0)throw new Error("User not found");const t=s.documents[0];return{$id:t.$id,name:t.name||"Anonymous User",username:t.username||null,bio:t.bio||null,avatar:t.avatar||null,emailVerification:t.emailVerification||!1,$createdAt:t.$createdAt,$updatedAt:t.$updatedAt}}catch(s){throw console.error("Error fetching user:",s),s}},enabled:!!e,staleTime:5*60*1e3,retry:1}),me=e=>{const s=Q.c(10),t=J(he),n=t?.$id;let i;s[0]!==n||s[1]!==e?(i=["isFollowing",n,e],s[0]=n,s[1]=e,s[2]=i):i=s[2];let r;s[3]!==e||s[4]!==t?(r=async()=>{if(!t?.$id||!e||t.$id===e)return!1;try{return(await C.listDocuments("main","user_follows",[g.equal("follower_id",t.$id),g.equal("following_id",e),g.limit(1)])).documents.length>0}catch(c){return console.error("Error checking follow status:",c),!1}},s[3]=e,s[4]=t,s[5]=r):r=s[5];const a=!!t?.$id&&!!e&&t.$id!==e;let o;return s[6]!==i||s[7]!==r||s[8]!==a?(o={queryKey:i,queryFn:r,enabled:a},s[6]=i,s[7]=r,s[8]=a,s[9]=o):o=s[9],H(o)},ue=e=>{const s=Q.c(7);let t,n;s[0]!==e?(t=["followersCount",e],n=async()=>{if(!e)return 0;try{return(await C.listDocuments("main","user_follows",[g.equal("following_id",e),g.limit(1)])).total}catch(a){return console.error("Error fetching followers count:",a),0}},s[0]=e,s[1]=t,s[2]=n):(t=s[1],n=s[2]);const i=!!e;let r;return s[3]!==t||s[4]!==n||s[5]!==i?(r={queryKey:t,queryFn:n,enabled:i},s[3]=t,s[4]=n,s[5]=i,s[6]=r):r=s[6],H(r)},fe=e=>{const s=Q.c(7);let t,n;s[0]!==e?(t=["followingCount",e],n=async()=>{if(!e)return 0;try{return(await C.listDocuments("main","user_follows",[g.equal("follower_id",e),g.limit(1)])).total}catch(a){return console.error("Error fetching following count:",a),0}},s[0]=e,s[1]=t,s[2]=n):(t=s[1],n=s[2]);const i=!!e;let r;return s[3]!==t||s[4]!==n||s[5]!==i?(r={queryKey:t,queryFn:n,enabled:i},s[3]=t,s[4]=n,s[5]=i,s[6]=r):r=s[6],H(r)},xe=()=>{const e=Q.c(8),s=ie(),t=J(we);let n;e[0]!==t?(n=async a=>{const{targetUserId:o,isCurrentlyFollowing:c}=a;if(!t?.$id||!o||t.$id===o)throw new Error("Invalid follow operation");if(c){const m=await C.listDocuments("main","user_follows",[g.equal("follower_id",t.$id),g.equal("following_id",o),g.limit(1)]);return m.documents.length>0&&await C.deleteDocument("main","user_follows",m.documents[0].$id),!1}else return await C.createDocument("main","user_follows","unique()",{follower_id:t.$id,following_id:o}),!0},e[0]=t,e[1]=n):n=e[1];let i;e[2]!==s||e[3]!==t?.$id?(i=(a,o)=>{const{targetUserId:c}=o;s.invalidateQueries({queryKey:["isFollowing",t?.$id,c]}),s.invalidateQueries({queryKey:["followersCount",c]}),s.invalidateQueries({queryKey:["followingCount",t?.$id]}),s.invalidateQueries({queryKey:["userStats",t?.$id]}),s.invalidateQueries({queryKey:["userStats",c]})},e[2]=s,e[3]=t?.$id,e[4]=i):i=e[4];let r;return e[5]!==n||e[6]!==i?(r={mutationFn:n,onSuccess:i,onError:ge},e[5]=n,e[6]=i,e[7]=r):r=e[7],ae(r)};function he(e){return e.user}function we(e){return e.user}function ge(e){console.error("Error toggling follow:",e)}const je=e=>{const s=Q.c(19),{targetUserId:t,variant:n,size:i,className:r,showText:a}=e,o=n===void 0?"default":n,c=i===void 0?"default":i,m=a===void 0?!0:a,b=J(ye),{data:d,isLoading:$}=me(t),{mutate:j,isPending:F}=xe(),{trackFollow:q}=Z();if(!b||b.$id===t)return null;let x;s[0]!==d||s[1]!==t||s[2]!==j||s[3]!==q?(x=()=>{const S=!d;j({targetUserId:t,isCurrentlyFollowing:d||!1},{onSuccess:()=>{q(t,S)}})},s[0]=d,s[1]=t,s[2]=j,s[3]=q,s[4]=x):x=s[4];const y=x,u=$||F,p=d?"outline":o,N=d&&"hover:bg-destructive hover:text-destructive-foreground hover:border-destructive";let h;s[5]!==r||s[6]!==N?(h=I("transition-all duration-200",N,r),s[5]=r,s[6]=N,s[7]=h):h=s[7];let f;s[8]!==d||s[9]!==u||s[10]!==m?(f=u?l.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):d?l.jsxs(l.Fragment,{children:[l.jsx(ce,{className:"h-4 w-4"}),m&&l.jsx("span",{className:"ml-2 hidden group-hover:inline sm:inline",children:"Unfollow"}),m&&l.jsx("span",{className:"ml-2 group-hover:hidden sm:hidden",children:"Following"})]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"h-4 w-4"}),m&&l.jsx("span",{className:"ml-2",children:"Follow"})]}),s[8]=d,s[9]=u,s[10]=m,s[11]=f):f=s[11];let w;return s[12]!==y||s[13]!==u||s[14]!==c||s[15]!==p||s[16]!==h||s[17]!==f?(w=l.jsx(se,{variant:p,size:c,onClick:y,disabled:u,className:h,children:f}),s[12]=y,s[13]=u,s[14]=c,s[15]=p,s[16]=h,s[17]=f,s[18]=w):w=s[18],w};function ye(e){return e.user}const _e=()=>{const e=Q.c(66),{userId:s}=te(),{data:t,isLoading:n}=de(s||""),{data:i,isLoading:r}=ue(s||""),{data:a,isLoading:o}=fe(s||"");if(n){let _;e[0]===Symbol.for("react.memo_cache_sentinel")?(_=l.jsx(v,{className:"h-20 w-20 rounded-full"}),e[0]=_):_=e[0];let z;e[1]===Symbol.for("react.memo_cache_sentinel")?(z=l.jsx(Y,{children:l.jsxs("div",{className:"flex items-start gap-6",children:[_,l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsx(v,{className:"h-8 w-48"}),l.jsx(v,{className:"h-4 w-32"}),l.jsx(v,{className:"h-4 w-24"})]}),l.jsx(v,{className:"h-10 w-24"})]})}),e[1]=z):z=e[1];let M;return e[2]===Symbol.for("react.memo_cache_sentinel")?(M=l.jsx("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:l.jsxs(R,{children:[z,l.jsx(G,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-6",children:[l.jsx(v,{className:"h-4 w-24"}),l.jsx(v,{className:"h-4 w-24"})]}),l.jsx(v,{className:"h-20 w-full"})]})})]})}),e[2]=M):M=e[2],M}if(!t){let _;return e[3]===Symbol.for("react.memo_cache_sentinel")?(_=l.jsx("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:l.jsx(R,{children:l.jsx(G,{className:"pt-6",children:l.jsxs("div",{className:"text-center py-8",children:[l.jsx(W,{className:"mx-auto h-12 w-12 text-muted-foreground"}),l.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"User not found"}),l.jsx("p",{className:"text-muted-foreground",children:"The user you're looking for doesn't exist."})]})})})}),e[3]=_):_=e[3],_}let c;e[4]!==t.$createdAt?(c=new Date(t.$createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long"}),e[4]=t.$createdAt,e[5]=c):c=e[5];const m=c;let b;e[6]!==t.avatar||e[7]!==t.name?(b=l.jsx("div",{className:"shrink-0",children:t.avatar?l.jsx("img",{src:t.avatar,alt:`${t.name}'s avatar`,className:"h-20 w-20 rounded-full object-cover ring-2 ring-border"}):l.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-secondary ring-2 ring-border",children:l.jsx(W,{className:"h-10 w-10 text-secondary-foreground"})})}),e[6]=t.avatar,e[7]=t.name,e[8]=b):b=e[8];let d;e[9]!==t.name?(d=l.jsx("h1",{className:"text-3xl font-bold truncate",children:t.name}),e[9]=t.name,e[10]=d):d=e[10];let $;e[11]!==t.emailVerification?($=t.emailVerification&&l.jsx(le,{variant:"secondary",className:"text-xs",children:"Verified"}),e[11]=t.emailVerification,e[12]=$):$=e[12];let j;e[13]!==d||e[14]!==$?(j=l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d,$]}),e[13]=d,e[14]=$,e[15]=j):j=e[15];let F;e[16]!==t.username?(F=t.username&&l.jsxs("p",{className:"text-muted-foreground mb-2",children:["@",t.username]}),e[16]=t.username,e[17]=F):F=e[17];let q;e[18]===Symbol.for("react.memo_cache_sentinel")?(q=l.jsx(re,{className:"h-4 w-4"}),e[18]=q):q=e[18];let x;e[19]!==m?(x=l.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[q,l.jsxs("span",{children:["Joined ",m]})]}),e[19]=m,e[20]=x):x=e[20];let y;e[21]!==j||e[22]!==F||e[23]!==x?(y=l.jsxs("div",{className:"flex-1 min-w-0",children:[j,F,x]}),e[21]=j,e[22]=F,e[23]=x,e[24]=y):y=e[24];let u;e[25]!==t.$id||e[26]!==t.name?(u=l.jsx("div",{className:"shrink-0",children:l.jsx(je,{targetUserId:t.$id,targetUserName:t.name,size:"default"})}),e[25]=t.$id,e[26]=t.name,e[27]=u):u=e[27];let p;e[28]!==b||e[29]!==y||e[30]!==u?(p=l.jsx(Y,{children:l.jsxs("div",{className:"flex items-start gap-6",children:[b,y,u]})}),e[28]=b,e[29]=y,e[30]=u,e[31]=p):p=e[31];let N;e[32]!==t.bio?(N=t.bio&&l.jsx("div",{className:"mb-6",children:l.jsx("p",{className:"text-sm leading-relaxed",children:t.bio})}),e[32]=t.bio,e[33]=N):N=e[33];let h;e[34]===Symbol.for("react.memo_cache_sentinel")?(h=l.jsx(O,{className:"h-4 w-4"}),e[34]=h):h=e[34];let f;e[35]!==a||e[36]!==o?(f=o?l.jsx(v,{className:"h-4 w-8 inline-block"}):a||0,e[35]=a,e[36]=o,e[37]=f):f=e[37];let w;e[38]!==f?(w=l.jsx("span",{className:"font-medium",children:f}),e[38]=f,e[39]=w):w=e[39];let S;e[40]===Symbol.for("react.memo_cache_sentinel")?(S=l.jsx("span",{className:"text-muted-foreground",children:"Following"}),e[40]=S):S=e[40];let k;e[41]!==w?(k=l.jsxs("div",{className:"flex items-center gap-1",children:[h,w,S]}),e[41]=w,e[42]=k):k=e[42];let V;e[43]===Symbol.for("react.memo_cache_sentinel")?(V=l.jsx(O,{className:"h-4 w-4"}),e[43]=V):V=e[43];let D;e[44]!==i||e[45]!==r?(D=r?l.jsx(v,{className:"h-4 w-8 inline-block"}):i||0,e[44]=i,e[45]=r,e[46]=D):D=e[46];let E;e[47]!==D?(E=l.jsx("span",{className:"font-medium",children:D}),e[47]=D,e[48]=E):E=e[48];let P;e[49]===Symbol.for("react.memo_cache_sentinel")?(P=l.jsx("span",{className:"text-muted-foreground",children:"Followers"}),e[49]=P):P=e[49];let U;e[50]!==E?(U=l.jsxs("div",{className:"flex items-center gap-1",children:[V,E,P]}),e[50]=E,e[51]=U):U=e[51];let K;e[52]!==k||e[53]!==U?(K=l.jsxs("div",{className:"flex gap-6 text-sm",children:[k,U]}),e[52]=k,e[53]=U,e[54]=K):K=e[54];let L;e[55]!==N||e[56]!==K?(L=l.jsxs(G,{children:[N,K]}),e[55]=N,e[56]=K,e[57]=L):L=e[57];let A;e[58]!==p||e[59]!==L?(A=l.jsxs(R,{children:[p,L]}),e[58]=p,e[59]=L,e[60]=A):A=e[60];let T;e[61]!==t.$id?(T=l.jsx(ne,{userId:t.$id,variant:"full"}),e[61]=t.$id,e[62]=T):T=e[62];let B;return e[63]!==A||e[64]!==T?(B=l.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl space-y-6",children:[A,T]}),e[63]=A,e[64]=T,e[65]=B):B=e[65],B};export{_e as PublicProfile};
