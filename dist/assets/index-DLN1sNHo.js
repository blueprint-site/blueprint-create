import{r as c,j as e}from"./radix-x8H_F-uE.js";import{l as he,c as ee,j as S,i as I,Y as xe,I as ue,J as ge,a5 as se,a6 as te,a7 as ae,D as fe,aL as $,ae as Ae,af as Ce,f as Se,a as $e,L as Ie,a_ as Me}from"./index-CV_NrdTx.js";import{D as Y}from"./data-table-CxezGhwt.js";import{a as De,b as pe,c as Le,d as Re}from"./useAddons-B6rbhemg.js";import{S as ie}from"./switch-BCDo1lB0.js";import{T as re,a as ne,b as E,c as V}from"./tabs-CB4bczku.js";import{C as ve}from"./checkbox-CM5neffb.js";import{C as je}from"./circle-x-Bk-HpeAp.js";import{m as T,A as W}from"./animation-RShxBXpy.js";import{L as B}from"./loader-circle-B7jcW4Fq.js";import{T as Te}from"./trash-2-DETmBeys.js";import{A as Ee,a as Ue}from"./arrow-right-UdhowPb2.js";import{u as Pe,a as Ke}from"./useFeaturedAddons-D2txhMuP.js";import{P as ze}from"./plus-DAvlroUo.js";import"./tanstack-aN5NUOUd.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],me=he("keyboard",Fe);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],He=he("undo-2",Ve),Oe=(i,g={})=>{const{enabled:t=!0,preventDefault:v=!0,ignoreInputs:n=!0}=g,j=c.useRef(i);return j.current=i,c.useEffect(()=>{if(!t)return;const u=o=>{if(n&&(o.target instanceof HTMLInputElement||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLSelectElement||o.target?.contentEditable==="true"))return;const m=j.current.find(f=>{const p=f.key.toLowerCase()===o.key.toLowerCase(),l=!!f.ctrl===(o.ctrlKey||o.metaKey),x=!!f.alt===o.altKey,y=!!f.shift===o.shiftKey;return p&&l&&x&&y});m&&(v&&o.preventDefault(),m.callback(o))};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[t,v,n]),{shortcuts:j.current}},Ye=(i,g)=>{const t=ee.c(33),v=g===void 0?!0:g;let n;t[0]!==i.onApprove?(n={key:"a",callback:i.onApprove,description:"Approve current addon"},t[0]=i.onApprove,t[1]=n):n=t[1];let j,u;t[2]!==i.onReject?(j={key:"r",callback:i.onReject,description:"Reject current addon"},u={key:"d",callback:i.onReject,description:"Reject current addon (alternative)"},t[2]=i.onReject,t[3]=j,t[4]=u):(j=t[3],u=t[4]);let o;t[5]!==i.onEnable?(o={key:"e",callback:i.onEnable,description:"Enable current addon"},t[5]=i.onEnable,t[6]=o):o=t[6];let m;t[7]!==i.onDisable?(m={key:"x",callback:i.onDisable,description:"Disable current addon"},t[7]=i.onDisable,t[8]=m):m=t[8];let f,p;t[9]!==i.onNext?(f={key:"ArrowDown",callback:i.onNext,description:"Move to next addon"},p={key:"j",callback:i.onNext,description:"Move to next addon (vim-style)"},t[9]=i.onNext,t[10]=f,t[11]=p):(f=t[10],p=t[11]);let l,x;t[12]!==i.onPrevious?(l={key:"ArrowUp",callback:i.onPrevious,description:"Move to previous addon"},x={key:"k",callback:i.onPrevious,description:"Move to previous addon (vim-style)"},t[12]=i.onPrevious,t[13]=l,t[14]=x):(l=t[13],x=t[14]);let y;t[15]!==i.onUndo?(y={key:"z",ctrl:!0,callback:i.onUndo,description:"Undo last action"},t[15]=i.onUndo,t[16]=y):y=t[16];let A;t[17]!==i.onExit?(A={key:"Escape",callback:i.onExit,description:"Exit review mode"},t[17]=i.onExit,t[18]=A):A=t[18];let M;t[19]!==n||t[20]!==y||t[21]!==A||t[22]!==j||t[23]!==u||t[24]!==o||t[25]!==m||t[26]!==f||t[27]!==p||t[28]!==l||t[29]!==x?(M=[n,j,u,o,m,f,p,l,x,y,A],t[19]=n,t[20]=y,t[21]=A,t[22]=j,t[23]=u,t[24]=o,t[25]=m,t[26]=f,t[27]=p,t[28]=l,t[29]=x,t[30]=M):M=t[30];const D=M;let b;return t[31]!==v?(b={enabled:v},t[31]=v,t[32]=b):b=t[32],Oe(D,b)},Be=()=>{const i=ee.c(1);let g;return i[0]===Symbol.for("react.memo_cache_sentinel")?(g=e.jsx("div",{children:"AddAddon works!"}),i[0]=g):g=i[0],g},Je=()=>{const t="60vh",[v,n]=c.useState(15),[j,u]=c.useState(""),[o,m]=c.useState("all"),{data:f,isLoading:p,isError:l,error:x,refetch:y}=De(),{mutateAsync:A,isPending:M}=pe(),D=c.useRef(null),b=c.useRef(null),U=f||[],N=U.filter(a=>{const h=j===""||a.name.toLowerCase().includes(j.toLowerCase())||a.authors?.join(", ").toLowerCase().includes(j.toLowerCase())||a.description?.toLowerCase().includes(j.toLowerCase());return o==="unchecked"?h&&!a.isChecked:h}),z=N.slice(0,v),k=v<N.length;c.useEffect(()=>{n(15)},[j,o]);const P=c.useCallback(()=>{k&&n(a=>Math.min(a+10,N.length))},[k,N.length]);c.useEffect(()=>{const a=new IntersectionObserver(L=>{L[0].isIntersecting&&k&&P()},{root:D.current,threshold:.1,rootMargin:"100px"}),h=b.current;return h&&a.observe(h),()=>{h&&a.unobserve(h)}},[P,k]);const J=async(a,h)=>{try{await A({addonId:a.$id,data:{isChecked:h}}),$({title:`Addon ${h?"marked as reviewed":"marked for review"}`,description:`${a.name} has been ${h?"reviewed":"marked for review"}.`}),y()}catch(L){$({variant:"destructive",title:"Update failed",description:"There was an error updating the review status."}),console.error("Unexpected error:",L)}},q=async(a,h)=>{try{const L=h?{isValid:h,isChecked:!0}:{isValid:h};await A({addonId:a.$id,data:L});let G={title:`Addon ${h?"activated":"deactivated"} successfully`,description:`${a.name} has been ${h?"approved":"disabled"}.`};h&&!a.isChecked&&(G.description+=" It has also been marked as reviewed."),$(G),y()}catch(L){$({variant:"destructive",title:"Update failed",description:"There was an error updating the addon status."}),console.error("Unexpected error:",L)}},H=[{accessorKey:"icon",header:"Icon",cell:({row:a})=>e.jsx(T.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:e.jsxs(se,{className:"border-border h-12 w-12 border",children:[e.jsx(te,{src:a.original.icon||"",alt:a.original.name}),e.jsx(ae,{className:"bg-primary/10 text-xs",children:a.original.name.slice(0,2).toUpperCase()})]})})},{accessorKey:"name",header:"Name",cell:({row:a})=>e.jsx("div",{className:"font-medium",children:a.original.name})},{accessorKey:"author",header:"Author",cell:({row:a})=>e.jsx("div",{className:"text-muted-foreground text-sm",children:a.original.authors?.join(", ")||"Unknown"})},{accessorKey:"description",header:"Description",cell:({row:a})=>e.jsx("div",{className:"max-w-md truncate text-sm",children:a.original.description||"No description available"})},{accessorKey:"review",header:"Review Status",cell:({row:a})=>e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{id:`review-${a.original.$id}`,checked:a.original.isChecked,onCheckedChange:h=>J(a.original,h===!0),disabled:M||a.original.isValid}),e.jsxs("label",{htmlFor:`review-${a.original.$id}`,className:`text-sm ${a.original.isValid?"text-muted-foreground cursor-not-allowed":"cursor-pointer"}`,children:[a.original.isChecked?"Reviewed":"Mark as reviewed",a.original.isValid&&!a.original.isChecked&&" (auto-marked when enabled)"]})]}),a.original.isChecked?e.jsx(I,{variant:"outline",className:"border-green-300 bg-green-100 text-green-800",children:"Reviewed"}):e.jsx(I,{variant:"outline",className:"border-yellow-300 bg-yellow-100 text-yellow-800",children:"Needs Review"})]})},{accessorKey:"isValid",header:"Status",cell:({row:a})=>e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{id:`status-${a.original.$id}`,checked:a.original.isValid,onCheckedChange:h=>q(a.original,h),disabled:M}),e.jsx("label",{htmlFor:`status-${a.original.$id}`,className:"cursor-pointer text-sm",children:a.original.isValid?"Enabled":"Disabled"})]}),a.original.isValid?e.jsx(I,{variant:"outline",className:"border-green-300 bg-green-100 text-green-800",children:"Approved"}):e.jsx(I,{variant:"outline",className:"border-red-300 bg-red-100 text-red-800",children:"Disabled"})]})},{accessorKey:"downloads",header:"Downloads",cell:({row:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fe,{size:14,className:"text-muted-foreground"}),e.jsx("span",{children:a.original.downloads||0})]})}];return p?e.jsx("div",{className:"flex min-h-[400px] w-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"border-primary h-8 w-8 animate-spin rounded-full border-4 border-t-transparent"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading addons..."})]})}):l?e.jsx("div",{className:"flex min-h-[400px] w-full items-center justify-center",children:e.jsxs("div",{className:"text-destructive flex flex-col items-center space-y-4",children:[e.jsx(je,{size:48}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Error loading addons"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:x?.message||"Unknown error"})]}),e.jsx(T.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(S,{onClick:()=>y(),variant:"outline",children:"Retry"})})]})}):e.jsxs("div",{className:"space-y-4 px-4 md:px-8",children:[e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Addons Management"}),e.jsxs("p",{className:"text-muted-foreground",children:["Review and manage addon extensions",U.filter(a=>!a.isChecked).length>0&&e.jsxs("span",{className:"ml-1",children:["(",e.jsx("span",{className:"font-medium text-yellow-600",children:U.filter(a=>!a.isChecked).length})," ","need review)"]})]})]}),e.jsxs(re,{defaultValue:"all",className:"w-full",onValueChange:m,children:[e.jsxs("div",{className:"mb-4 flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[e.jsxs(ne,{children:[e.jsx(E,{value:"all",children:"All Addons"}),e.jsxs(E,{value:"unchecked",children:["Needs Review",!p&&U.filter(a=>!a.isChecked).length>0&&e.jsx(I,{variant:"secondary",className:"ml-1",children:U.filter(a=>!a.isChecked).length})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"text-muted-foreground absolute top-2.5 left-2 h-4 w-4"}),e.jsx(ue,{placeholder:"Search addons...",value:j,onChange:a=>u(a.target.value),className:"w-full max-w-xs pl-8"})]})]}),e.jsxs("div",{className:"bg-background/60 text-muted-foreground sticky top-0 z-10 flex items-center justify-between border-b py-2 text-sm backdrop-blur-sm",children:[e.jsxs("span",{children:["Displaying ",z.length," of ",N.length," addons"]}),N.length>15&&e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>n(N.length),disabled:v>=N.length,children:"Show all"})]}),e.jsx(W,{mode:"wait",children:e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"relative",children:e.jsxs("div",{ref:D,className:"border-border overflow-y-auto rounded-md border",style:{height:t},children:[e.jsxs(V,{value:"all",className:"mt-0",children:[e.jsx(Y,{columns:H,data:z}),k&&e.jsx("div",{ref:b,className:"flex items-center justify-center py-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"text-muted-foreground h-5 w-5 animate-spin"}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"Loading more..."})]})}),!k&&v===N.length&&N.length>15&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center py-4 text-sm",children:["Showing all ",N.length," results"]})]}),e.jsxs(V,{value:"unchecked",className:"mt-0",children:[e.jsx(Y,{columns:H,data:z}),k&&e.jsx("div",{ref:b,className:"flex items-center justify-center py-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"text-muted-foreground h-5 w-5 animate-spin"}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"Loading more..."})]})}),!k&&v===N.length&&N.length>15&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center py-4 text-sm",children:["Showing all ",N.length," results"]})]})]})},o)})]})]}),N.length===0&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"flex h-40 items-center justify-center rounded-md border border-dashed",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2 text-center",children:[e.jsx(ge,{size:20,className:"text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"No addons found"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:o==="unchecked"?"All addons have been reviewed!":"Try adjusting your search criteria."})]})]})})]})},ye=()=>{const[i,g]=c.useState(1),[t,v]=c.useState(""),[n,j]=c.useState("unsorted"),[u,o]=c.useState(!1),[m,f]=c.useState(0),[p,l]=c.useState([]),[x,y]=c.useState([]),[A,M]=c.useState(new Set),D=25,{data:b,isLoading:U,isError:N,error:z,refetch:k,isFetching:P}=Le({search:n==="history"||t.trim()!==""?"":void 0,reviewStatus:n==="history"?"all":n},i,D),{data:J,isLoading:q,isFetching:H}=Re(t.trim(),i,D),{mutateAsync:a,isPending:h}=pe(),L=c.useRef(null),O=n==="history"?{addons:x.map(s=>s.addon),total:x.length,totalPages:Math.ceil(x.length/D)}:t.trim()?J||{addons:[],total:0,totalPages:1}:b||{addons:[],total:0,totalPages:1},w=n==="history"||t.trim()?O.addons:O.addons.filter(s=>!A.has(s.$id)),K=n==="history"?Math.ceil(x.length/D):O.totalPages,de=t.trim()?q:U,X=t.trim()?H:P;c.useEffect(()=>{g(1),f(0),n==="history"&&M(new Set)},[t,n]),c.useEffect(()=>{m>=w.length&&w.length>0&&f(0)},[i,w.length,m]);const le=c.useCallback(s=>{const r={...s,id:`${Date.now()}-${Math.random()}`,timestamp:Date.now()};l(d=>[r,...d].slice(0,10))},[]),oe=c.useCallback((s,r)=>{const d={id:`${Date.now()}-${Math.random()}`,addon:{...s},action:r,timestamp:Date.now()};y(C=>[d,...C].slice(0,10)),M(C=>new Set([...C,s.$id]))},[]),Ne=c.useCallback(()=>{y([]),$({title:"History cleared",description:"Review history has been cleared."})},[]),ce=c.useCallback(async()=>{if(p.length===0)return;const s=p[0];try{await a({addonId:s.addonId,data:{[s.field]:s.previousValue}}),l(r=>r.slice(1)),M(r=>{const d=new Set(r);return d.delete(s.addonId),d}),y(r=>r.filter(d=>d.addon.$id!==s.addonId)),$({title:"Action undone",description:`Reverted ${s.addonName} to previous state.`}),k()}catch{$({variant:"destructive",title:"Undo failed",description:"Could not undo the last action."})}},[p,a,k]),Z=async(s,r,d=!1)=>{try{if(le({addonId:s.$id,addonName:s.name,field:"isChecked",previousValue:s.isChecked,newValue:r}),await a({addonId:s.$id,data:{isChecked:r}}),oe(s,r?"approved":"rejected"),$({title:`Addon ${r?"approved":"marked for review"}`,description:`${s.name} has been ${r?"approved":"marked for review"}.`}),u&&d){const R=w.filter(F=>F.$id!==s.$id);m>=R.length&&R.length>0&&f(R.length-1)}k()}catch{$({variant:"destructive",title:"Update failed",description:"There was an error updating the review status."})}},_=async(s,r,d=!1)=>{try{le({addonId:s.$id,addonName:s.name,field:"isValid",previousValue:s.isValid,newValue:r});const C=r?{isValid:r,isChecked:!0}:{isValid:r};await a({addonId:s.$id,data:C}),oe(s,r?"enabled":"disabled");let F={title:`Addon ${r?"activated":"deactivated"} successfully`,description:`${s.name} has been ${r?"approved":"disabled"}.`};if(r&&!s.isChecked&&(F.description+=" It has also been marked as reviewed."),$(F),u&&d){const Q=w.filter(ke=>ke.$id!==s.$id);m>=Q.length&&Q.length>0&&f(Q.length-1)}k()}catch{$({variant:"destructive",title:"Update failed",description:"There was an error updating the addon status."})}};Ye({onApprove:()=>{const s=w[m];s&&!s.isChecked&&Z(s,!0,!0)},onReject:()=>{const s=w[m];s&&!s.isChecked&&Z(s,!0,!0)},onEnable:()=>{const s=w[m];s&&!s.isValid&&_(s,!0,!0)},onDisable:()=>{const s=w[m];s&&s.isValid&&_(s,!1,!0)},onNext:()=>{f(s=>Math.min(s+1,w.length-1))},onPrevious:()=>{f(s=>Math.max(s-1,0))},onUndo:ce,onExit:()=>o(!1)},u&&w.length>0),c.useEffect(()=>{if(u&&L.current){const s=L.current.querySelector(`[data-addon-index="${m}"]`);s&&s.scrollIntoView({behavior:"smooth",block:"center"})}},[m,u]);const we=[{accessorKey:"icon",header:"Icon",cell:({row:s})=>e.jsx(T.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:e.jsxs(se,{className:"h-12 w-12",children:[e.jsx(te,{src:s.original.icon||"",alt:`${s.original.name} icon`}),e.jsx(ae,{children:s.original.name.charAt(0).toUpperCase()})]})})},{accessorKey:"name",header:"Name",cell:({row:s})=>{let r=null;if(s.original.modrinth_raw)try{const d=typeof s.original.modrinth_raw=="string"?JSON.parse(s.original.modrinth_raw):s.original.modrinth_raw;d?.slug&&(r=`https://modrinth.com/mod/${d.slug}`)}catch(d){console.warn("Failed to parse modrinth_raw data:",d)}if(!r&&s.original.curseforge_raw)try{const d=typeof s.original.curseforge_raw=="string"?JSON.parse(s.original.curseforge_raw):s.original.curseforge_raw;d?.links?.websiteUrl&&(r=d.links.websiteUrl)}catch(d){console.warn("Failed to parse curseforge_raw data:",d)}return r?e.jsx(Ie,{to:r,target:"_blank",rel:"noopener noreferrer",children:e.jsx("div",{className:"font-medium transition-colors hover:text-blue-600 dark:hover:text-blue-400",children:s.original.name})}):e.jsx("div",{className:"font-medium",children:s.original.name})}},{accessorKey:"authors",header:"Authors",cell:({row:s})=>e.jsx("div",{className:"text-muted-foreground text-sm",children:s.original.authors.join(", ")||"Unknown"})},{accessorKey:"description",header:"Description",cell:({row:s})=>e.jsx("div",{className:"max-w-md truncate text-sm",children:s.original.description||"No description available"})},...n==="history"?[{accessorKey:"action",header:"Action Taken",cell:({row:s})=>{const r=x.find(C=>C.addon.$id===s.original.$id);if(!r)return null;const d={approved:"bg-green-100 text-green-800 border-green-300",rejected:"bg-yellow-100 text-yellow-800 border-yellow-300",enabled:"bg-blue-100 text-blue-800 border-blue-300",disabled:"bg-red-100 text-red-800 border-red-300"};return e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx(I,{variant:"outline",className:d[r.action],children:r.action.charAt(0).toUpperCase()+r.action.slice(1)}),e.jsx("span",{className:"text-muted-foreground text-xs",children:new Date(r.timestamp).toLocaleString()})]})}}]:[{accessorKey:"review",header:"Review Status",cell:({row:s,table:r})=>{const d=r.getRowModel().rows.findIndex(R=>R.original.$id===s.original.$id),C=u&&m===d;return e.jsxs("div",{className:`flex flex-col space-y-2 rounded-md p-2 transition-colors ${C?"bg-blue-100 ring-2 ring-blue-500 dark:bg-blue-900/20":""}`,"data-addon-index":d,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{id:`review-${s.original.$id}`,checked:s.original.isChecked,onCheckedChange:R=>Z(s.original,R===!0),disabled:h||s.original.isValid}),e.jsxs("label",{htmlFor:`review-${s.original.$id}`,className:`text-sm ${s.original.isValid?"text-muted-foreground cursor-not-allowed":"cursor-pointer"}`,children:[s.original.isChecked?"Reviewed":"Mark as reviewed",s.original.isValid&&!s.original.isChecked&&" (auto-marked when enabled)"]})]}),s.original.isChecked?e.jsx(I,{variant:"outline",className:"w-fit border-green-300 bg-green-100 text-green-800",children:"Reviewed"}):e.jsx(I,{variant:"outline",className:"w-fit border-yellow-300 bg-yellow-100 text-yellow-800",children:"Needs Review"})]})}},{accessorKey:"isValid",header:"Status",cell:({row:s})=>e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{id:`valid-${s.original.$id}`,checked:s.original.isValid,onCheckedChange:r=>_(s.original,r),disabled:h}),e.jsx("label",{htmlFor:`valid-${s.original.$id}`,className:"text-sm",children:s.original.isValid?"Enabled":"Disabled"})]}),e.jsx(I,{variant:s.original.isValid?"default":"destructive",className:"w-fit",children:s.original.isValid?"Active":"Inactive"})]})}],{accessorKey:"downloads",header:"Downloads",cell:({row:s})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fe,{size:14,className:"text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.original.downloads?.toLocaleString()||"0"})]})}];return N?e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(je,{size:24}),e.jsx("span",{className:"text-lg font-medium",children:"Failed to load addons"})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:z?.message||"Unknown error"}),e.jsx(S,{onClick:()=>k(),variant:"outline",children:"Retry"})]})}):e.jsxs("div",{className:"space-y-6 px-4 md:px-8",children:[e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Addons Management"}),e.jsxs("p",{className:"text-muted-foreground",children:["Review and manage addon extensions efficiently",b&&b.total>0&&e.jsxs("span",{className:"ml-1",children:["(Page ",i," of ",K,", ",b.total," total)"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p.length>0&&e.jsxs(S,{variant:"outline",size:"sm",onClick:ce,disabled:h,className:"flex items-center space-x-1",children:[e.jsx(He,{size:16}),e.jsxs("span",{children:["Undo (",p.length,")"]})]}),n==="history"&&x.length>0&&e.jsxs(S,{variant:"outline",size:"sm",onClick:Ne,className:"flex items-center space-x-1",children:[e.jsx(Te,{size:16}),e.jsx("span",{children:"Clear History"})]}),e.jsxs(S,{variant:u?"default":"outline",size:"sm",onClick:()=>o(!u),className:"flex items-center space-x-1",children:[e.jsx(me,{size:16}),e.jsx("span",{children:u?"Exit Review Mode":"Review Mode"})]})]})]}),e.jsx(W,{children:u&&e.jsx(T.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-4 space-y-3",children:e.jsxs(Ae,{className:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsxs(Ce,{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{children:e.jsx("strong",{children:"Review Mode Active"})}),e.jsxs("span",{className:"rounded bg-blue-100 px-2 py-1 text-xs dark:bg-blue-900",children:[m+1," of ",w.length," addon",w.length!==1?"s":""]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"A"})," ","approve,"," ",e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"R"})," ","reject,"," ",e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"E"})," ","enable,"," ",e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"X"})," ","disable,"," ",e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"â†‘/â†“"})," ","navigate,"," ",e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"Ctrl+Z"})," ","undo,"," ",e.jsx("kbd",{className:"rounded-sm bg-gray-200 p-1 text-xs dark:bg-gray-700",children:"Esc"})," ","exit"]}),w.length>0&&e.jsx("div",{className:"mt-2 text-xs",children:"ðŸ’¡ Actions automatically move to the next addon for faster review"})]})]})})})]}),e.jsxs(re,{defaultValue:"unsorted",className:"w-full",onValueChange:s=>j(s),children:[e.jsxs("div",{className:"mb-4 flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[e.jsxs(ne,{children:[e.jsxs(E,{value:"unsorted",children:["Unsorted",b&&e.jsx(I,{variant:"destructive",className:"ml-1",children:b.addons.filter(s=>!s.isValid&&!A.has(s.$id)).length})]}),e.jsx(E,{value:"all",children:"All Addons (Approved)"}),e.jsxs(E,{value:"unreviewed",children:["Needs Review",b&&e.jsx(I,{variant:"secondary",className:"ml-1",children:b.addons.filter(s=>!s.isChecked&&!A.has(s.$id)).length})]}),e.jsx(E,{value:"reviewed",children:"Reviewed"}),e.jsxs(E,{value:"history",children:["History",e.jsx(I,{variant:"outline",className:"ml-1",children:x.length})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"text-muted-foreground absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2"}),e.jsx(ue,{placeholder:n==="history"?"Search history...":"Search all addons...",value:t,onChange:s=>v(s.target.value),className:"w-[300px] pl-10",disabled:n==="history"})]})]}),e.jsx(V,{value:n,className:"mt-0",children:e.jsx(W,{mode:"wait",children:e.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsx(Se,{children:e.jsx($e,{className:"p-0",children:e.jsx("div",{ref:L,className:"max-h-[70vh] overflow-auto",children:de||X?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:t.trim()?"Searching addons...":"Loading addons..."})]})}):e.jsx(Y,{columns:we,data:n==="history"?x.slice((i-1)*D,i*D).map(s=>s.addon):w})})})}),K>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>g(s=>Math.max(s-1,1)),disabled:i===1||P,children:[e.jsx(Ee,{size:16}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,K)},(s,r)=>{let d;if(K<=5)d=r+1;else{const C=Math.max(1,i-2),R=Math.min(K,C+4);d=Math.max(1,R-4)+r}return e.jsx(S,{variant:i===d?"default":"outline",size:"sm",onClick:()=>g(d),disabled:P,className:"w-10",children:d},d)})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>g(s=>Math.min(s+1,K)),disabled:i===K||P,children:["Next",e.jsx(Ue,{size:16})]})]}),e.jsxs("div",{className:"text-muted-foreground mt-4 flex items-center justify-between text-sm",children:[e.jsx("div",{children:X&&n!=="history"?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:t.trim()?"Searching...":"Loading..."})]}):e.jsxs("span",{children:["Showing ",w.length," of"," ",n==="history"?x.length:O.total," ","addons",n==="history"&&" (from recent actions)",t.trim()&&" (search results)"]})}),p.length>0&&e.jsxs("div",{children:["Last ",p.length," action",p.length!==1?"s":""," in history"]})]})]},`${i}-${n}-${t}`)})})]}),!de&&!X&&w.length===0&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"flex h-40 items-center justify-center rounded-md border border-dashed",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2 text-center",children:[e.jsx(ge,{size:20,className:"text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:n==="history"?"No review history yet":(t.trim(),"No addons found")}),e.jsx("p",{className:"text-muted-foreground text-xs",children:n==="history"?"Actions taken on addons will appear here.":t.trim()?"Try adjusting your search terms.":n==="unreviewed"?"All addons have been reviewed!":"Try adjusting your search criteria."})]})]})})]})},qe=()=>{const i=ee.c(3);let g;i[0]===Symbol.for("react.memo_cache_sentinel")?(g=e.jsxs(ne,{children:[e.jsx(E,{className:"cursor-pointer",value:"addons",children:"All Addons"}),e.jsx(E,{className:"cursor-pointer",value:"featured",children:"Featured"})]}),i[0]=g):g=i[0];let t;i[1]===Symbol.for("react.memo_cache_sentinel")?(t=e.jsx(V,{value:"addons",children:e.jsx(ye,{})}),i[1]=t):t=i[1];let v;return i[2]===Symbol.for("react.memo_cache_sentinel")?(v=e.jsxs(re,{defaultValue:"addons",className:"p-6",children:[g,t,e.jsx(V,{value:"featured",children:e.jsx(be,{})})]}),i[2]=v):v=i[2],v},be=()=>{const[i,g]=c.useState(1),{data:t,isLoading:v,isError:n,error:j,refetch:u}=Pe(!1),{mutateAsync:o}=Ke(),m=t||[],f=async(l,x)=>{try{await o({id:l.$id,addon:{active:x}}),$({className:"bg-surface-3 border-ring text-foreground",title:`âœ… Addon ${x?"activÃ©":"dÃ©sactivÃ©"} âœ…`}),u()}catch(y){$({className:"bg-surface-3 border-ring text-foreground",title:"âŒ Erreur de mise Ã  jour âŒ"}),console.error("Unexpected error:",y)}},p=[{accessorKey:"image_url",header:"Image",cell:({row:l})=>e.jsxs(se,{children:[e.jsx(te,{src:l.original.image_url||""}),e.jsx(ae,{children:"ADDON"})]})},{accessorKey:"addon_id",header:"Addon ID"},{accessorKey:"title",header:"Title",cell:({row:l})=>e.jsx("span",{className:"font-medium",children:l.original.title})},{accessorKey:"description",header:"Description"},{accessorKey:"active",header:({column:l})=>e.jsxs(S,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),children:["Status",e.jsx(Me,{className:"ml-2 h-4 w-4"})]}),cell:({row:l})=>e.jsx(ie,{checked:l.original.active,onCheckedChange:x=>f(l.original,x)})}];return v?e.jsx("div",{children:"Chargement..."}):n?e.jsxs("div",{children:["Erreur: ",j?.message]}):e.jsxs("div",{children:[e.jsx("div",{className:"float-end",children:e.jsxs(S,{variant:"success",className:"cursor-pointer",children:[e.jsx(ze,{})," ADD ADDON"]})}),e.jsxs("div",{className:"px-4 md:px-8",children:[e.jsx(Y,{columns:p,data:m}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(S,{onClick:()=>g(l=>Math.max(l-1,1)),children:"PrÃ©cÃ©dent"}),e.jsxs("span",{children:["Page ",i]}),e.jsx(S,{onClick:()=>g(l=>l+1),children:"Suivant"})]})]})]})},cs={AddAddon:Be,AddonsTable:Je,OptimizedAddonsTable:ye,AdminAddonsMain:qe,FeaturedAddonsTable:be};export{Be as AddAddon,Je as AddonsTable,qe as AdminAddonsMain,be as FeaturedAddonsTable,ye as OptimizedAddonsTable,cs as default};
