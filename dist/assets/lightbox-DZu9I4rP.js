import{r as a,j as n}from"./radix-IrtRZmCq.js";import{m as X,y as oe,x as se,n as k,r as d,_ as ce,br as re,am as $,aF as le,bs as ie,bt as ue}from"./index-KCZmE9lu.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],me=X("rotate-cw",he);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],de=X("zoom-in",xe);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ge=X("zoom-out",ye),we=({images:r,currentIndex:Z,onClose:Y,alt:A="Gallery image"})=>{const[u,C]=a.useState(Z),[s,w]=a.useState(1),[O,N]=a.useState(0),[i,m]=a.useState({x:0,y:0}),[x,j]=a.useState(!1),[y,L]=a.useState({x:0,y:0}),[g,f]=a.useState({x:0,y:0}),[h,b]=a.useState({x:0,y:0}),[U,M]=a.useState(!0),[_,R]=a.useState(!1),q=a.useRef(null),B=a.useRef(null);a.useEffect(()=>{w(1),N(0),m({x:0,y:0}),f({x:0,y:0}),b({x:0,y:0}),M(!0),R(!1)},[u]),a.useEffect(()=>{const t=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement))switch(e.key){case"Escape":Y();break;case"ArrowLeft":e.preventDefault(),z();break;case"ArrowRight":e.preventDefault(),E();break;case"+":case"=":e.preventDefault(),T();break;case"-":e.preventDefault(),S();break;case"0":e.preventDefault(),P();break;case"r":case"R":e.preventDefault(),F();break}};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[u,r.length]);const z=a.useCallback(()=>{C(t=>(t-1+r.length)%r.length)},[r.length]),E=a.useCallback(()=>{C(t=>(t+1)%r.length)},[r.length]),T=a.useCallback(()=>{const t=Math.min(s*1.2,5),e=t/s;w(t),m(o=>({x:o.x*e,y:o.y*e}))},[s]),S=a.useCallback(()=>{const t=Math.max(s/1.2,.1),e=t/s;w(t),m(o=>({x:o.x*e,y:o.y*e}))},[s]),F=a.useCallback(()=>{N(t=>(t+90)%360)},[]),P=a.useCallback(()=>{w(1),N(0),m({x:0,y:0}),f({x:0,y:0}),b({x:0,y:0})},[]),V=a.useCallback(t=>{if(s<=1)return;t.preventDefault(),j(!0),b({x:0,y:0});const e=t.currentTarget.getBoundingClientRect(),o=t.clientX-e.left,c=t.clientY-e.top;L({x:o-i.x,y:c-i.y}),f({x:t.clientX,y:t.clientY})},[s,i]),G=a.useCallback(t=>{if(!x||s<=1)return;t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),o=t.clientX-e.left,c=t.clientY-e.top,l=o-y.x,p=c-y.y,v=t.clientX-g.x,D=t.clientY-g.y;m({x:l,y:p}),b({x:v,y:D}),f({x:t.clientX,y:t.clientY})},[x,y,s,g]),I=a.useCallback(()=>{if(x&&(j(!1),Math.abs(h.x)>2||Math.abs(h.y)>2)){let e=h.x*.85,o=h.y*.85;const c=()=>{Math.abs(e)<.5&&Math.abs(o)<.5||(m(l=>({x:l.x+e,y:l.y+o})),e*=.92,o*=.92,requestAnimationFrame(c))};requestAnimationFrame(c)}},[x,h]),H=a.useCallback(t=>{if(s<=1||t.touches.length!==1)return;t.preventDefault();const e=t.touches[0],o=t.currentTarget.getBoundingClientRect(),c=e.clientX-o.left,l=e.clientY-o.top;j(!0),b({x:0,y:0}),L({x:c-i.x,y:l-i.y}),f({x:e.clientX,y:e.clientY})},[s,i]),W=a.useCallback(t=>{if(!x||s<=1||t.touches.length!==1)return;t.preventDefault();const e=t.touches[0],o=t.currentTarget.getBoundingClientRect(),c=e.clientX-o.left,l=e.clientY-o.top,p=c-y.x,v=l-y.y,D=e.clientX-g.x,ae=e.clientY-g.y;m({x:p,y:v}),b({x:D,y:ae}),f({x:e.clientX,y:e.clientY})},[x,y,s,g]),K=a.useCallback(()=>{if(x&&(j(!1),Math.abs(h.x)>1||Math.abs(h.y)>1)){let e=h.x*1.2,o=h.y*1.2;const c=()=>{Math.abs(e)<.3&&Math.abs(o)<.3||(m(l=>({x:l.x+e,y:l.y+o})),e*=.9,o*=.9,requestAnimationFrame(c))};requestAnimationFrame(c)}},[x,h]),J=a.useCallback(t=>{t.preventDefault();const e=.15,o=t.deltaY<0?1+e:1-e,c=Math.max(.1,Math.min(5,s*o));if(c===s)return;const l=c/s,p=i.x*l,v=i.y*l;w(c),m({x:p,y:v})},[s,i]),Q=a.useCallback(()=>{M(!1),R(!1)},[]),ee=a.useCallback(()=>{M(!1),R(!0)},[]),te=a.useCallback(async()=>{try{const e=await(await fetch(r[u])).blob(),o=window.URL.createObjectURL(e),c=document.createElement("a");c.href=o,c.download=`image-${u+1}.${e.type.split("/")[1]||"jpg"}`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)}catch(t){console.error("Failed to download image:",t)}},[r,u]),ne=r[u];return n.jsx(oe,{open:!0,onOpenChange:Y,children:n.jsxs(se,{ref:B,className:k("w-screen h-screen max-w-none max-h-none p-0 border-none bg-black/95 backdrop-blur-sm","data-[state=open]:duration-300 data-[state=closed]:duration-200"),"aria-label":`Image ${u+1} of ${r.length}`,children:[n.jsx("div",{className:"absolute top-0 left-0 right-0 z-50 bg-gradient-to-b from-black/80 to-transparent p-4",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("div",{className:"flex items-center gap-2 text-white",children:n.jsxs("span",{className:"text-lg font-medium",children:[u+1," / ",r.length]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(d,{variant:"ghost",size:"sm",onClick:S,disabled:s<=.1,className:"text-white hover:bg-white/20",title:"Zoom out (-)",children:n.jsx(ge,{className:"h-4 w-4"})}),n.jsxs("span",{className:"text-white text-sm min-w-[3rem] text-center",children:[Math.round(s*100),"%"]}),n.jsx(d,{variant:"ghost",size:"sm",onClick:T,disabled:s>=5,className:"text-white hover:bg-white/20",title:"Zoom in (+)",children:n.jsx(de,{className:"h-4 w-4"})}),n.jsx(d,{variant:"ghost",size:"sm",onClick:F,className:"text-white hover:bg-white/20",title:"Rotate (R)",children:n.jsx(me,{className:"h-4 w-4"})}),n.jsx(d,{variant:"ghost",size:"sm",onClick:te,className:"text-white hover:bg-white/20",title:"Download image",children:n.jsx(ce,{className:"h-4 w-4"})}),n.jsx(re,{asChild:!0,children:n.jsx(d,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/20",title:"Close (Esc)",children:n.jsx($,{className:"h-4 w-4"})})})]})]})}),n.jsxs("div",{className:k("flex-1 flex items-center justify-center relative overflow-hidden transition-transform duration-75",x?"cursor-grabbing":s>1?"cursor-grab":"cursor-default"),onMouseDown:V,onMouseMove:G,onMouseUp:I,onMouseLeave:I,onWheel:J,onTouchStart:H,onTouchMove:W,onTouchEnd:K,style:{touchAction:s>1?"none":"auto"},children:[U&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:n.jsx(le,{className:"h-8 w-8 animate-spin text-white"})}),_?n.jsxs("div",{className:"text-white text-center",children:[n.jsx($,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Failed to load image"})]}):n.jsx("img",{ref:q,src:ne,alt:`${A} ${u+1}`,className:k("max-w-full max-h-full object-contain select-none pointer-events-none","transition-transform duration-75 ease-out"),style:{transform:`translate(${i.x}px, ${i.y}px) scale(${s}) rotate(${O}deg)`,transformOrigin:"center center"},onLoad:Q,onError:ee,draggable:!1})]}),r.length>1&&n.jsxs(n.Fragment,{children:[n.jsx(d,{variant:"ghost",size:"lg",onClick:z,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-40",title:"Previous image (←)",children:n.jsx(ie,{className:"h-8 w-8"})}),n.jsx(d,{variant:"ghost",size:"lg",onClick:E,className:"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-40",title:"Next image (→)",children:n.jsx(ue,{className:"h-8 w-8"})})]}),r.length>1&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:n.jsx("div",{className:"flex justify-center gap-2 overflow-x-auto max-w-full",children:r.map((t,e)=>n.jsx("button",{onClick:()=>C(e),className:k("flex-shrink-0 w-16 h-16 rounded border-2 overflow-hidden transition-all",e===u?"border-white shadow-lg scale-110":"border-white/30 hover:border-white/60"),title:`Go to image ${e+1}`,children:n.jsx("img",{src:t,alt:`Thumbnail ${e+1}`,className:"w-full h-full object-cover"})},e))})}),n.jsx("div",{className:"absolute bottom-20 left-1/2 -translate-x-1/2 text-white/70 text-sm text-center opacity-60 animate-pulse",children:n.jsx("p",{children:"Arrow keys: navigate • Mouse wheel: zoom • Drag: pan • R: rotate • 0: reset"})})]})})};export{we as L};
