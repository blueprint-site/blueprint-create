import{r as c,j as n}from"./radix-B0d9A4Hp.js";import{q as Y}from"./index-DqfNU3ry.js";import{C as ne}from"./cog-CIvQV2jN.js";import"./tanstack-BKPRn8Ud.js";import"./animation-tNjqXOyv.js";const m=10,b=20,A={I:"bg-cyan-500",J:"bg-blue-700",L:"bg-orange-500",O:"bg-yellow-500",S:"bg-green-500",T:"bg-purple-500",Z:"bg-red-500",empty:""},L={I:{name:"diamond",path:"/public/minecraft-textures/diamond_block.png"},J:{name:"lapis",path:"/public/minecraft-textures/lapis_block.png"},L:{name:"copper",path:"/public/minecraft-textures/copper_block.png"},O:{name:"gold",path:"/public/minecraft-textures/gold_block.png"},S:{name:"emerald",path:"/public/minecraft-textures/emerald_block.png"},T:{name:"obsidian",path:"/public/minecraft-textures/bookshelf.png"},Z:{name:"redstone",path:"/public/minecraft-textures/tnt_side.png"}},R={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],O:[[1,1],[1,1]],S:[[0,1,1],[1,1,0],[0,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]]},re={QWERTY:{left:["a","A"],right:["d","D"],down:["s","S"],rotate:["w","W"],drop:[" "]},AZERTY:{left:["q","Q"],right:["d","D"],down:["s","S"],rotate:["z","Z"],drop:[" "]}},fe=()=>{const[h,M]=c.useState(J()),[l,w]=c.useState(null),[i,g]=c.useState({x:0,y:0}),[d,T]=c.useState(null),[f,W]=c.useState(0),[u,N]=c.useState(!1),[y,z]=c.useState(!1),[v,G]=c.useState(1),[Q,B]=c.useState(2e3),[Z,S]=c.useState(!1),[j,_]=c.useState(0),[k,I]=c.useState(0),[P,V]=c.useState("QWERTY");function J(){return Array(b).fill(null).map(()=>Array(m).fill(null))}const C=c.useCallback(()=>{const t=Object.keys(R),e=t[Math.floor(Math.random()*t.length)];return{shape:R[e],type:e}},[]),$=()=>{M(J());const t=C(),e=C();w(t),T(e),g({x:Math.floor(m/2)-1,y:0}),W(0),N(!1),S(!1),z(!0),G(1),B(1e3),I(0)},p=c.useCallback((t,e)=>{for(let s=0;s<t.shape.length;s++)for(let r=0;r<t.shape[s].length;r++)if(t.shape[s][r]){const a=e.x+r,o=e.y+s;if(a<0||a>=m||o>=b||o>=0&&h[o][a]!==null)return!1}return!0},[h]),H=c.useCallback((t,e)=>{for(let s=0;s<t.shape.length;s++)for(let r=0;r<t.shape[s].length;r++)if(t.shape[s][r]){const a=e.x+r,o=e.y+s;if(a<0||a>=m||o>=b||o>=0&&h[o][a]!==null)return!1}return!0},[h]),X=c.useCallback(()=>{if(!l||u)return;const t=[];for(let s=0;s<l.shape[0].length;s++){const r=[];for(let a=l.shape.length-1;a>=0;a--)r.push(l.shape[a][s]);t.push(r)}const e={...l,shape:t};p(e,i)&&w(e)},[l,i,u,p]),K=c.useCallback(t=>{let e=0;for(let s=b-1;s>=0;s--)if(t[s].every(r=>r!==null)){e+=1;for(let r=s;r>0;r--)t[r]=[...t[r-1]];t[0]=Array(m).fill(null),s+=1}if(e>0){const s=k+e;I(s);const r=f+e*100*v;W(r);const a=Math.floor(s/10)+1;a>v&&(G(a),B(Math.max(100,1e3-(a-1)*100)))}},[f,v,k]),E=c.useCallback(()=>{if(!l||!d)return;let t=!1;for(let a=0;a<l.shape.length;a++){for(let o=0;o<l.shape[a].length;o++)if(l.shape[a][o]&&i.y+a>=0){t=!0;break}if(t)break}if(!t){N(!0),S(!0),f>j&&_(f);return}const e=JSON.parse(JSON.stringify(h));for(let a=0;a<l.shape.length;a++)for(let o=0;o<l.shape[a].length;o++)if(l.shape[a][o]){const D=i.x+o,O=i.y+a;if(O>=0&&O<b&&D>=0&&D<m)e[O][D]=l.type;else if(O<0){N(!0),S(!0),f>j&&_(f);return}}M(e),K(e);const s=C(),r={x:Math.floor(m/2)-1,y:0};H(d,r)?(w(d),T(s),g(r)):(w(d),T(s),g(r),N(!0),S(!0),f>j&&_(f))},[h,l,d,i,C,f,j,H,K]),x=c.useCallback(t=>{if(!l||u)return!1;const e={...i};switch(t){case"left":e.x-=1;break;case"right":e.x+=1;break;case"down":e.y+=1;break;default:return!1}return p(l,e)?(g(e),!0):(t==="down"&&E(),!1)},[i,l,u,p,E]),q=c.useCallback(()=>{if(!l||u)return;let t={...i},e=!0;for(;e;)p(l,{...t,y:t.y+1})?t={...t,y:t.y+1}:e=!1;g(t),E()},[i,l,u,p,E]),F=()=>{V(t=>t==="QWERTY"?"AZERTY":"QWERTY")};c.useEffect(()=>{const t=e=>{if(!y||u)return;const s=re[P];s.left.includes(e.key)?(x("left"),e.preventDefault()):s.right.includes(e.key)?(x("right"),e.preventDefault()):s.down.includes(e.key)?(x("down"),e.preventDefault()):s.rotate.includes(e.key)?(X(),e.preventDefault()):s.drop.includes(e.key)&&(q(),e.preventDefault())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[y,u,x,X,q,P]),c.useEffect(()=>{if(!y||u)return;const t=setInterval(()=>{x("down")},Q);return()=>{clearInterval(t)}},[y,u,x,Q]);const U=()=>{const t=JSON.parse(JSON.stringify(h));if(l){for(let e=0;e<l.shape.length;e++)for(let s=0;s<l.shape[e].length;s++)if(l.shape[e][s]){const r=i.x+s,a=i.y+e;a>=0&&a<b&&r>=0&&r<m&&(t[a][r]=l.type)}}return n.jsx("div",{className:"bg-brass_casing border-4 p-2",children:n.jsx("div",{className:"relative inline-block",children:t.map((e,s)=>n.jsx("div",{className:"flex",children:e.map((r,a)=>n.jsx("div",{className:`h-8 w-8 ${r?A[r]:A.empty} flex items-center justify-center`,children:r&&n.jsx("img",{src:L[r].path,alt:L[r].name,className:"h-full w-full object-cover"})},`${a}-${s}`))},s))})})},ee=()=>{const t=P==="QWERTY"?{move:"A/D",down:"S",rotate:"W"}:{move:"Q/D",down:"S",rotate:"Z"};return n.jsxs("div",{className:"font-minecraft text-white",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx(ne,{}),n.jsx("p",{children:" Controls:"})]}),n.jsx(Y,{onClick:F,variant:"outline",className:"m-2 cursor-pointer",children:P==="QWERTY"?"Switch to AZERTY":"Switch to QWERTY"}),n.jsxs("ul",{className:"list-disc pl-5",children:[n.jsxs("li",{children:[t.move,": Move left/right"]}),n.jsxs("li",{children:[t.down,": Move down"]}),n.jsxs("li",{children:[t.rotate,": Rotate"]})]})]})},te=()=>Z?n.jsx("div",{className:"bg-opacity-80 absolute inset-0 z-10 flex items-center justify-center bg-black",children:n.jsxs("div",{className:"bg-shadow_steel_casing w-5/6 rounded-lg p-8 text-center",children:[n.jsx("h2",{className:"mb-4 text-4xl font-bold text-red-500",children:"Game Over!"}),n.jsxs("div",{className:"mb-6 space-y-3",children:[n.jsxs("p",{className:"font-minecraft text-yellow-400",children:["Final Score: ",n.jsx("span",{className:"font-bold",children:f})]}),n.jsxs("p",{className:"font-minecraft text-green-400",children:["High Score: ",n.jsx("span",{className:"font-bold",children:Math.max(f,j)})]}),n.jsxs("p",{className:"font-minecraft text-blue-400",children:["Level Reached: ",n.jsx("span",{className:"font-bold",children:v})]}),n.jsxs("p",{className:"font-minecraft text-purple-400",children:["Lines Cleared: ",n.jsx("span",{className:"font-bold",children:k})]})]}),n.jsx(Y,{onClick:$,className:"font-minecraft w-full cursor-pointer",children:"New Game"})]})}):null,se=()=>d?n.jsxs("div",{className:"mb-4 p-4",children:[n.jsx("h3",{className:"font-minecraft text-center text-white",children:"Next Piece"}),n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:`grid grid-cols-${R[d.type][0].length}`,children:R[d.type].map((t,e)=>t.map((s,r)=>n.jsx("div",{className:`h-5 w-5 ${s?A[d.type]:""}`,children:s===1&&n.jsx("img",{src:L[d.type].path,alt:L[d.type].name,className:"h-full w-full object-cover"})},`next-${r}-${e}`)))})})]}):null;return n.jsxs("div",{className:"flex flex-col items-center p-4",children:[n.jsx("h1",{className:"font-minecraft mb-4 text-3xl font-bold",children:"Minecraft Tetris"}),n.jsxs("div",{className:"flex flex-col items-start gap-8 md:flex-row",children:[n.jsxs("div",{className:"relative",children:[U(),te()]}),n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("div",{className:"bg-brass_casing mb-4 w-full p-4",children:[se(),n.jsxs("p",{className:"font-minecraft mb-2 text-xl text-yellow-400",children:["Score: ",f]}),n.jsxs("p",{className:"font-minecraft mb-2 text-xl text-green-400",children:["Level: ",v]}),n.jsxs("p",{className:"font-minecraft mb-2 text-xl text-blue-400",children:["Lines: ",k]}),u&&!Z&&n.jsx("div",{className:"mb-4 text-xl font-bold text-red-500",children:"Game Over!"}),n.jsx(Y,{onClick:$,variant:"default",className:"font-minecraft w-full cursor-pointer",children:y?"Restart":"Start"})]}),ee()]})]})]})};export{fe as default};
